/**
 * @license
 *
 * DHTMLX ToDo v.1.0.0
 *
 * This software is covered by DHTMLX Evaluation License and purposed only for evaluation.
 * Contact sales@dhtmlx.com to get Commercial or Enterprise license.
 * Usage without proper license is prohibited.
 *
 * (c) XB Software.
 */
var todo=function(t){"use strict";function e(t,e="data-id"){let n=t;for(!n.tagName&&t.target&&(n=t.target);n;){if(n.getAttribute){if(n.getAttribute(e))return n}n=n.parentNode}return null}function n(t,n="data-id"){const o=e(t,n);return o?function(t){if("string"==typeof t){const e=1*t;if(!isNaN(e))return e}return t}(o.getAttribute(n)):null}function o(t,o){let s=null;t.addEventListener("click",(function(t){const n=e(t);if(!n)return;const i=parseInt(n.dataset.id);let r,a=t.target;for(;a!=n;){if(r=a.dataset?a.dataset.action:null,r){o[r]&&o[r](i,t),s=(new Date).valueOf();break}a=a.parentNode}o.click&&!r&&o.click(i,t)})),t.addEventListener("dblclick",(function(t){if(s&&(new Date).valueOf()-s<200)return;const e=n(t);e&&o.dblclick&&o.dblclick(e,t)}))}function s(t){return t&&"object"==typeof t&&!Array.isArray(t)}function i(t,e){for(const n in e){const o=e[n];s(t[n])&&s(o)?t[n]=i({...t[n]},e[n]):t[n]=e[n]}return t}function r(t){return{getGroup(e){const n=t[e];return t=>n&&n[t]||t},getRaw:()=>t,extend(e,n){if(!e)return this;let o;return o=n?i({...e},t):i({...t},e),r(o)}}}function a(){}function c(t,e){for(const n in e)t[n]=e[n];return t}function l(t){return t()}function d(){return Object.create(null)}function u(t){t.forEach(l)}function p(t){return"function"==typeof t}function f(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function h(t,...e){if(null==t)return a;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function g(t,e,n){t.$$.on_destroy.push(h(e,n))}function $(t,e,n,o){if(t){const s=m(t,e,n,o);return t[0](s)}}function m(t,e,n,o){return t[1]&&o?c(n.ctx.slice(),t[1](o(e))):n.ctx}function v(t,e,n,o){if(t[2]&&o){const s=t[2](o(n));if(void 0===e.dirty)return s;if("object"==typeof s){const t=[],n=Math.max(e.dirty.length,s.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|s[o];return t}return e.dirty|s}return e.dirty}function k(t,e,n,o,s,i){if(s){const r=m(e,n,o,i);t.p(r,s)}}function x(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function w(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function b(t,e){const n={};e=new Set(e);for(const o in t)e.has(o)||"$"===o[0]||(n[o]=t[o]);return n}function y(t){return null==t?"":t}function _(t){return t&&p(t.destroy)?t.destroy:a}function j(t,e){t.appendChild(e)}function S(t,e,n){t.insertBefore(e,n||null)}function T(t){t.parentNode.removeChild(t)}function D(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function C(t){return document.createElement(t)}function I(t){return document.createTextNode(t)}function P(){return I(" ")}function M(){return I("")}function N(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function E(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function A(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function F(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function O(t,e){t.value=null==e?"":e}function R(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function L(t,e,n){t.classList[n?"add":"remove"](e)}(new Date).valueOf();class Y{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.e=C(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)S(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(T)}}let z;function B(t){z=t}function H(){if(!z)throw new Error("Function called outside component initialization");return z}function W(t){H().$$.on_mount.push(t)}function G(){const t=H();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const s=function(t,e,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,!1,e),o}(e,n);o.slice().forEach((e=>{e.call(t,s)}))}}}function V(t,e){H().$$.context.set(t,e)}function J(t){return H().$$.context.get(t)}function U(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const q=[],Q=[],K=[],X=[],Z=Promise.resolve();let tt=!1;function et(t){K.push(t)}function nt(t){X.push(t)}let ot=!1;const st=new Set;function it(){if(!ot){ot=!0;do{for(let t=0;t<q.length;t+=1){const e=q[t];B(e),rt(e.$$)}for(B(null),q.length=0;Q.length;)Q.pop()();for(let t=0;t<K.length;t+=1){const e=K[t];st.has(e)||(st.add(e),e())}K.length=0}while(q.length);for(;X.length;)X.pop()();tt=!1,ot=!1,st.clear()}}function rt(t){if(null!==t.fragment){t.update(),u(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(et)}}const at=new Set;let ct;function lt(){ct={r:0,c:[],p:ct}}function dt(){ct.r||u(ct.c),ct=ct.p}function ut(t,e){t&&t.i&&(at.delete(t),t.i(e))}function pt(t,e,n,o){if(t&&t.o){if(at.has(t))return;at.add(t),ct.c.push((()=>{at.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}const ft="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function ht(t,e){t.d(1),e.delete(t.key)}function gt(t,e){pt(t,1,1,(()=>{e.delete(t.key)}))}function $t(t,e,n,o,s,i,r,a,c,l,d,u){let p=t.length,f=i.length,h=p;const g={};for(;h--;)g[t[h].key]=h;const $=[],m=new Map,v=new Map;for(h=f;h--;){const t=u(s,i,h),a=n(t);let c=r.get(a);c?o&&c.p(t,e):(c=l(a,t),c.c()),m.set(a,$[h]=c),a in g&&v.set(a,Math.abs(h-g[a]))}const k=new Set,x=new Set;function w(t){ut(t,1),t.m(a,d),r.set(t.key,t),d=t.first,f--}for(;p&&f;){const e=$[f-1],n=t[p-1],o=e.key,s=n.key;e===n?(d=e.first,p--,f--):m.has(s)?!r.has(o)||k.has(o)?w(e):x.has(s)?p--:v.get(o)>v.get(s)?(x.add(o),w(e)):(k.add(s),p--):(c(n,r),p--)}for(;p--;){const e=t[p];m.has(e.key)||c(e,r)}for(;f;)w($[f-1]);return $}function mt(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function vt(t){t&&t.c()}function kt(t,e,n,o){const{fragment:s,on_mount:i,on_destroy:r,after_update:a}=t.$$;s&&s.m(e,n),o||et((()=>{const e=i.map(l).filter(p);r?r.push(...e):u(e),t.$$.on_mount=[]})),a.forEach(et)}function xt(t,e){const n=t.$$;null!==n.fragment&&(u(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function wt(t,e){-1===t.$$.dirty[0]&&(q.push(t),tt||(tt=!0,Z.then(it)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function bt(t,e,n,o,s,i,r,c=[-1]){const l=z;B(t);const p=t.$$={fragment:null,ctx:null,props:i,update:a,not_equal:s,bound:d(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:d(),dirty:c,skip_bound:!1,root:e.target||l.$$.root};r&&r(p.root);let f=!1;if(p.ctx=n?n(t,e.props||{},((e,n,...o)=>{const i=o.length?o[0]:n;return p.ctx&&s(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),f&&wt(t,e)),n})):[],p.update(),f=!0,u(p.before_update),p.fragment=!!o&&o(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(T)}else p.fragment&&p.fragment.c();e.intro&&ut(t.$$.fragment),kt(t,e.target,e.anchor,e.customElement),it()}B(l)}class yt{$destroy(){xt(this,1),this.$destroy=a}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function _t(t){let e;return{c(){e=C("span"),A(e,"class","spacer svelte-1sypd9a")},m(t,n){S(t,e,n)},p:a,d(t){t&&T(e)}}}function jt(t){let e,n,o;return{c(){e=C("i"),A(e,"class","pager wxi-angle-left svelte-1sypd9a")},m(s,i){S(s,e,i),n||(o=N(e,"click",(function(){p(t[0])&&t[0].apply(this,arguments)})),n=!0)},p(e,n){t=e},d(t){t&&T(e),n=!1,o()}}}function St(t){let e;return{c(){e=C("span"),A(e,"class","spacer svelte-1sypd9a")},m(t,n){S(t,e,n)},p:a,d(t){t&&T(e)}}}function Tt(t){let e,n,o;return{c(){e=C("i"),A(e,"class","pager wxi-angle-right svelte-1sypd9a")},m(s,i){S(s,e,i),n||(o=N(e,"click",(function(){p(t[1])&&t[1].apply(this,arguments)})),n=!0)},p(e,n){t=e},d(t){t&&T(e),n=!1,o()}}}function Dt(t){let e,n,o,s,i,r,c;function l(t,e){return"right"!=t[2]?jt:_t}let d=l(t),u=d(t);function p(t,e){return"left"!=t[2]?Tt:St}let f=p(t),h=f(t);return{c(){e=C("div"),u.c(),n=P(),o=C("span"),s=I(t[3]),i=P(),h.c(),A(o,"class","label svelte-1sypd9a"),A(e,"class","header svelte-1sypd9a")},m(a,l){S(a,e,l),u.m(e,null),j(e,n),j(e,o),j(o,s),j(e,i),h.m(e,null),r||(c=N(o,"click",t[4]),r=!0)},p(t,[o]){d===(d=l(t))&&u?u.p(t,o):(u.d(1),u=d(t),u&&(u.c(),u.m(e,n))),8&o&&F(s,t[3]),f===(f=p(t))&&h?h.p(t,o):(h.d(1),h=f(t),h&&(h.c(),h.m(e,null)))},i:a,o:a,d(t){t&&T(e),u.d(),h.d(),r=!1,c()}}}function Ct(t,e,n){const o=J("wx-i18n").getRaw().calendar.monthFull;let s,i,r,{date:a}=e,{type:c}=e,{prev:l}=e,{next:d}=e,{part:u}=e;return t.$$set=t=>{"date"in t&&n(6,a=t.date),"type"in t&&n(5,c=t.type),"prev"in t&&n(0,l=t.prev),"next"in t&&n(1,d=t.next),"part"in t&&n(2,u=t.part)},t.$$.update=()=>{if(480&t.$$.dirty)switch(n(7,s=a.getMonth()),n(8,i=a.getFullYear()),c){case"month":n(3,r=`${o[s]} ${i}`);break;case"year":n(3,r=i);break;case"duodecade":{const t=i-i%10;n(3,r=`${t} - ${t+9}`);break}}},[l,d,u,r,function(){"month"===c?n(5,c="year"):"year"===c&&n(5,c="duodecade")},c,a,s,i]}class It extends yt{constructor(t){super(),bt(this,t,Ct,Dt,f,{date:6,type:5,prev:0,next:1,part:2})}}function Pt(t,e,n){const o=t.slice();return o[16]=e[n],o}function Mt(t,e,n){const o=t.slice();return o[16]=e[n],o}function Nt(t){let e,n,o=t[16]+"";return{c(){e=C("div"),n=I(o),A(e,"class","weekday svelte-102f3tn")},m(t,o){S(t,e,o),j(e,n)},p:a,d(t){t&&T(e)}}}function Et(t,e){let n,o,s,i,r,a=e[16].day+"";return{key:t,first:null,c(){n=C("div"),o=I(a),s=P(),A(n,"class",i="day "+e[16].css+" svelte-102f3tn"),A(n,"data-id",r=e[16].date),L(n,"out",!e[16].in),this.first=n},m(t,e){S(t,n,e),j(n,o),j(n,s)},p(t,s){e=t,1&s&&a!==(a=e[16].day+"")&&F(o,a),1&s&&i!==(i="day "+e[16].css+" svelte-102f3tn")&&A(n,"class",i),1&s&&r!==(r=e[16].date)&&A(n,"data-id",r),1&s&&L(n,"out",!e[16].in)},d(t){t&&T(n)}}}function At(t){let e,n,s,i,r,c=[],l=new Map,d=t[1],u=[];for(let e=0;e<d.length;e+=1)u[e]=Nt(Mt(t,d,e));let p=t[0];const f=t=>t[16].date;for(let e=0;e<p.length;e+=1){let n=Pt(t,p,e),o=f(n);l.set(o,c[e]=Et(o,n))}return{c(){e=C("div");for(let t=0;t<u.length;t+=1)u[t].c();n=P(),s=C("div");for(let t=0;t<c.length;t+=1)c[t].c();A(e,"class","weekdays svelte-102f3tn"),A(s,"class","days svelte-102f3tn")},m(a,l){S(a,e,l);for(let t=0;t<u.length;t+=1)u[t].m(e,null);S(a,n,l),S(a,s,l);for(let t=0;t<c.length;t+=1)c[t].m(s,null);i||(r=_(o.call(null,s,t[2])),i=!0)},p(t,[n]){if(2&n){let o;for(d=t[1],o=0;o<d.length;o+=1){const s=Mt(t,d,o);u[o]?u[o].p(s,n):(u[o]=Nt(s),u[o].c(),u[o].m(e,null))}for(;o<u.length;o+=1)u[o].d(1);u.length=d.length}1&n&&(p=t[0],c=$t(c,n,f,1,t,p,l,s,ht,Et,null,Pt))},i:a,o:a,d(t){t&&T(e),D(u,t),t&&T(n),t&&T(s);for(let t=0;t<c.length;t+=1)c[t].d();i=!1,r()}}}function Ft(t){const e=t.getDay();return 0===e||6===e}function Ot(t,e,n){let{value:o}=e,{current:s}=e,{cancel:i}=e,{part:r}=e,{markers:a=null}=e;const c=J("wx-i18n").getRaw().calendar,l=(c.weekStart||7)%7,d=c.dayShort.slice(l).concat(c.dayShort.slice(0,l));let u,p;const f=(t,e,n)=>new Date(t.getFullYear(),t.getMonth()+(e||0),t.getDate()+(n||0));let h="normal"!==r;const g={click:function(t,e){e.stopPropagation(),t?(n(4,s=new Date(t)),"normal"===r?n(3,o=new Date(s)):(o||n(3,o={start:null,end:null}),o.end||!o.start?n(3,o={start:new Date(s),end:null}):(n(3,o.end=new Date(s),o),o.end<o.start&&n(3,[o.start,o.end]=[o.end,o.start],o)))):(n(3,o=null),n(4,s=new Date));"normal"===r&&i()}};return t.$$set=t=>{"value"in t&&n(3,o=t.value),"current"in t&&n(4,s=t.current),"cancel"in t&&n(5,i=t.cancel),"part"in t&&n(6,r=t.part),"markers"in t&&n(7,a=t.markers)},t.$$.update=()=>{if(473&t.$$.dirty){n(8,p="normal"==r?[o?f(o).valueOf():0]:o?[o.start?f(o.start).valueOf():0,o.end?f(o.end).valueOf():0]:[0,0]);const t=function(){const t=f(s,0,1-s.getDate());return t.setDate(t.getDate()-(t.getDay()-(l-7))%7),t}(),e=function(){const t=f(s,1,-s.getDate());return t.setDate(t.getDate()+(6-t.getDay()+l)%7),t}(),i=s.getMonth();n(0,u=[]);for(let n=t;n<=e;n.setDate(n.getDate()+1)){const t={day:n.getDate(),in:n.getMonth()===i,date:n.valueOf()};let e="";if(e+=t.in?"":" inactive",e+=p.indexOf(t.date)>-1?" selected":"",h){const n=t.date==p[0],o=t.date==p[1];n&&!o?e+=" left":o&&!n&&(e+=" right"),t.date>p[0]&&t.date<p[1]&&(e+=" inrange")}if(e+=Ft(n)?" weekend":"",a){const t=a(n);t&&(e+=" "+t)}u.push({...t,css:e})}}},[u,d,g,o,s,i,r,a,p]}class Rt extends yt{constructor(t){super(),bt(this,t,Ot,At,f,{value:3,current:4,cancel:5,part:6,markers:7})}}function Lt(t){let e,n,o,s;const i=t[2].default,r=$(i,t,t[1],null);return{c(){e=C("button"),r&&r.c(),A(e,"class","svelte-1bjiwod")},m(i,a){S(i,e,a),r&&r.m(e,null),n=!0,o||(s=N(e,"click",(function(){p(t[0])&&t[0].apply(this,arguments)})),o=!0)},p(e,[o]){t=e,r&&r.p&&(!n||2&o)&&k(r,i,t,t[1],n?v(i,t[1],o,null):x(t[1]),null)},i(t){n||(ut(r,t),n=!0)},o(t){pt(r,t),n=!1},d(t){t&&T(e),r&&r.d(t),o=!1,s()}}}function Yt(t,e,n){let{$$slots:o={},$$scope:s}=e,{click:i}=e;return t.$$set=t=>{"click"in t&&n(0,i=t.click),"$$scope"in t&&n(1,s=t.$$scope)},[i,s,o]}class zt extends yt{constructor(t){super(),bt(this,t,Yt,Lt,f,{click:0})}}function Bt(t,e,n){const o=t.slice();return o[9]=e[n],o[11]=n,o}function Ht(t){let e,n,o,s,i=t[9]+"";return{c(){e=C("div"),n=I(i),o=P(),A(e,"class","month svelte-1nvkxt9"),A(e,"data-id",s=t[11]),L(e,"current",t[1]===t[11])},m(t,s){S(t,e,s),j(e,n),j(e,o)},p(t,n){2&n&&L(e,"current",t[1]===t[11])},d(t){t&&T(e)}}}function Wt(t){let e,n=t[2].done+"";return{c(){e=I(n)},m(t,n){S(t,e,n)},p:a,d(t){t&&T(e)}}}function Gt(t){let e,n,s,i,r,a,c,l=t[3],d=[];for(let e=0;e<l.length;e+=1)d[e]=Ht(Bt(t,l,e));return i=new zt({props:{click:t[0],$$slots:{default:[Wt]},$$scope:{ctx:t}}}),{c(){e=C("div");for(let t=0;t<d.length;t+=1)d[t].c();n=P(),s=C("div"),vt(i.$$.fragment),A(e,"class","months svelte-1nvkxt9"),A(s,"class","buttons svelte-1nvkxt9")},m(l,u){S(l,e,u);for(let t=0;t<d.length;t+=1)d[t].m(e,null);S(l,n,u),S(l,s,u),kt(i,s,null),r=!0,a||(c=_(o.call(null,e,t[4])),a=!0)},p(t,[n]){if(10&n){let o;for(l=t[3],o=0;o<l.length;o+=1){const s=Bt(t,l,o);d[o]?d[o].p(s,n):(d[o]=Ht(s),d[o].c(),d[o].m(e,null))}for(;o<d.length;o+=1)d[o].d(1);d.length=l.length}const o={};1&n&&(o.click=t[0]),4096&n&&(o.$$scope={dirty:n,ctx:t}),i.$set(o)},i(t){r||(ut(i.$$.fragment,t),r=!0)},o(t){pt(i.$$.fragment,t),r=!1},d(t){t&&T(e),D(d,t),t&&T(n),t&&T(s),xt(i),a=!1,c()}}}function Vt(t,e,n){let{value:o}=e,{current:s}=e,{cancel:i}=e,{part:r}=e;const a=J("wx-i18n").getRaw().calendar,c=a.monthShort;let l;const d={click:function(t){t&&(s.setMonth(t),n(6,s));"normal"===r&&n(5,o=new Date(s));i()}};return t.$$set=t=>{"value"in t&&n(5,o=t.value),"current"in t&&n(6,s=t.current),"cancel"in t&&n(0,i=t.cancel),"part"in t&&n(7,r=t.part)},t.$$.update=()=>{224&t.$$.dirty&&("normal"!==r&&o?"left"===r&&o.start?n(1,l=o.start.getMonth()):"right"===r&&o.end?n(1,l=o.end.getMonth()):n(1,l=s.getMonth()):n(1,l=s.getMonth()))},[i,l,a,c,d,o,s,r]}class Jt extends yt{constructor(t){super(),bt(this,t,Vt,Gt,f,{value:5,current:6,cancel:0,part:7})}}function Ut(t,e,n){const o=t.slice();return o[9]=e[n],o[11]=n,o}function qt(t){let e,n,o,s,i=t[9]+"";return{c(){e=C("div"),n=I(i),o=P(),A(e,"class","year svelte-62ny1k"),A(e,"data-id",s=t[9]),L(e,"current",t[2]==t[9]),L(e,"prev-decade",0===t[11]),L(e,"next-decade",11===t[11])},m(t,s){S(t,e,s),j(e,n),j(e,o)},p(t,o){2&o&&i!==(i=t[9]+"")&&F(n,i),2&o&&s!==(s=t[9])&&A(e,"data-id",s),6&o&&L(e,"current",t[2]==t[9])},d(t){t&&T(e)}}}function Qt(t){let e,n=t[3].done+"";return{c(){e=I(n)},m(t,n){S(t,e,n)},p:a,d(t){t&&T(e)}}}function Kt(t){let e,n,s,i,r,a,c,l=t[1],d=[];for(let e=0;e<l.length;e+=1)d[e]=qt(Ut(t,l,e));return i=new zt({props:{click:t[0],$$slots:{default:[Qt]},$$scope:{ctx:t}}}),{c(){e=C("div");for(let t=0;t<d.length;t+=1)d[t].c();n=P(),s=C("div"),vt(i.$$.fragment),A(e,"class","years svelte-62ny1k"),A(s,"class","buttons svelte-62ny1k")},m(l,u){S(l,e,u);for(let t=0;t<d.length;t+=1)d[t].m(e,null);S(l,n,u),S(l,s,u),kt(i,s,null),r=!0,a||(c=_(o.call(null,e,t[4])),a=!0)},p(t,[n]){if(6&n){let o;for(l=t[1],o=0;o<l.length;o+=1){const s=Ut(t,l,o);d[o]?d[o].p(s,n):(d[o]=qt(s),d[o].c(),d[o].m(e,null))}for(;o<d.length;o+=1)d[o].d(1);d.length=l.length}const o={};1&n&&(o.click=t[0]),4096&n&&(o.$$scope={dirty:n,ctx:t}),i.$set(o)},i(t){r||(ut(i.$$.fragment,t),r=!0)},o(t){pt(i.$$.fragment,t),r=!1},d(t){t&&T(e),D(d,t),t&&T(n),t&&T(s),xt(i),a=!1,c()}}}function Xt(t,e,n){const o=J("wx-i18n").getRaw().calendar;let s,i,{value:r}=e,{current:a}=e,{cancel:c}=e,{part:l}=e;const d={click:function(t){t&&(a.setFullYear(t),n(6,a));"normal"===l&&n(5,r=new Date(a));c()}};return t.$$set=t=>{"value"in t&&n(5,r=t.value),"current"in t&&n(6,a=t.current),"cancel"in t&&n(0,c=t.cancel),"part"in t&&n(7,l=t.part)},t.$$.update=()=>{if(230&t.$$.dirty){"normal"!==l&&r?"left"===l&&r.start?n(2,i=r.start.getFullYear()):"right"===l&&r.end?n(2,i=r.end.getFullYear()):n(2,i=a.getFullYear()):n(2,i=a.getFullYear());const t=i-i%10-1,e=t+12;n(1,s=[]);for(let n=t;n<e;++n)s.push(n)}},[c,s,i,o,d,r,a,l]}class Zt extends yt{constructor(t){super(),bt(this,t,Xt,Kt,f,{value:5,current:6,cancel:0,part:7})}}function te(t){let e,n,o,s,i,r,a;return o=new zt({props:{click:t[13],$$slots:{default:[ee]},$$scope:{ctx:t}}}),r=new zt({props:{click:t[14],$$slots:{default:[ne]},$$scope:{ctx:t}}}),{c(){e=C("div"),n=C("div"),vt(o.$$.fragment),s=P(),i=C("div"),vt(r.$$.fragment),A(n,"class","button-item svelte-sor66p"),A(i,"class","button-item svelte-sor66p"),A(e,"class","buttons svelte-sor66p")},m(t,c){S(t,e,c),j(e,n),kt(o,n,null),j(e,s),j(e,i),kt(r,i,null),a=!0},p(t,e){const n={};16777216&e&&(n.$$scope={dirty:e,ctx:t}),o.$set(n);const s={};16777216&e&&(s.$$scope={dirty:e,ctx:t}),r.$set(s)},i(t){a||(ut(o.$$.fragment,t),ut(r.$$.fragment,t),a=!0)},o(t){pt(o.$$.fragment,t),pt(r.$$.fragment,t),a=!1},d(t){t&&T(e),xt(o),xt(r)}}}function ee(t){let e,n=t[6]("clear")+"";return{c(){e=I(n)},m(t,n){S(t,e,n)},p:a,d(t){t&&T(e)}}}function ne(t){let e,n=t[6]("today")+"";return{c(){e=I(n)},m(t,n){S(t,e,n)},p:a,d(t){t&&T(e)}}}function oe(t){let e,n,o,s,i,r,a,c,l,d,u,p;function f(e){t[10](e)}let h={date:t[1],part:t[2],prev:t[7][t[5]].prev,next:t[7][t[5]].next};function g(e){t[11](e)}function $(e){t[12](e)}void 0!==t[5]&&(h.type=t[5]),o=new It({props:h}),Q.push((()=>mt(o,"type",f)));var m=t[7][t[5]].component;function v(t){let e={part:t[2],markers:t[3],cancel:t[7][t[5]].cancel};return void 0!==t[0]&&(e.value=t[0]),void 0!==t[1]&&(e.current=t[1]),{props:e}}m&&(a=new m(v(t)),Q.push((()=>mt(a,"value",g))),Q.push((()=>mt(a,"current",$))));let k="month"===t[5]&&"normal"===t[2]&&t[4]&&te(t);return{c(){e=C("div"),n=C("div"),vt(o.$$.fragment),i=P(),r=C("div"),a&&vt(a.$$.fragment),d=P(),k&&k.c(),A(r,"class","body"),A(n,"class","wrap svelte-sor66p"),A(e,"class",u="calendar "+("normal"!==t[2]?"part":"")+" svelte-sor66p")},m(t,s){S(t,e,s),j(e,n),kt(o,n,null),j(n,i),j(n,r),a&&kt(a,r,null),j(r,d),k&&k.m(r,null),p=!0},p(t,[n]){const i={};2&n&&(i.date=t[1]),4&n&&(i.part=t[2]),32&n&&(i.prev=t[7][t[5]].prev),32&n&&(i.next=t[7][t[5]].next),!s&&32&n&&(s=!0,i.type=t[5],nt((()=>s=!1))),o.$set(i);const f={};if(4&n&&(f.part=t[2]),8&n&&(f.markers=t[3]),32&n&&(f.cancel=t[7][t[5]].cancel),!c&&1&n&&(c=!0,f.value=t[0],nt((()=>c=!1))),!l&&2&n&&(l=!0,f.current=t[1],nt((()=>l=!1))),m!==(m=t[7][t[5]].component)){if(a){lt();const t=a;pt(t.$$.fragment,1,0,(()=>{xt(t,1)})),dt()}m?(a=new m(v(t)),Q.push((()=>mt(a,"value",g))),Q.push((()=>mt(a,"current",$))),vt(a.$$.fragment),ut(a.$$.fragment,1),kt(a,r,d)):a=null}else m&&a.$set(f);"month"===t[5]&&"normal"===t[2]&&t[4]?k?(k.p(t,n),52&n&&ut(k,1)):(k=te(t),k.c(),ut(k,1),k.m(r,null)):k&&(lt(),pt(k,1,1,(()=>{k=null})),dt()),(!p||4&n&&u!==(u="calendar "+("normal"!==t[2]?"part":"")+" svelte-sor66p"))&&A(e,"class",u)},i(t){p||(ut(o.$$.fragment,t),a&&ut(a.$$.fragment,t),ut(k),p=!0)},o(t){pt(o.$$.fragment,t),a&&pt(a.$$.fragment,t),pt(k),p=!1},d(t){t&&T(e),xt(o),a&&xt(a),k&&k.d()}}}function se(t,e,n){const o=J("wx-i18n").getGroup("calendar");let{value:s}=e,{current:i}=e,{cancel:r=null}=e,{part:a="normal"}=e,{markers:c=null}=e,{buttons:l=!0}=e,d="month";const u={month:{component:Rt,next:function(){i.setMonth(i.getMonth()+1),n(1,i),n(0,s)},prev:function(){let t=new Date(i);t.setMonth(i.getMonth()-1);for(;i.getMonth()===t.getMonth();)t.setDate(t.getDate()-1);n(1,i=t)},cancel:p},year:{component:Jt,next:function(){i.setFullYear(i.getFullYear()+1),n(1,i),n(0,s)},prev:function(){i.setFullYear(i.getFullYear()-1),n(1,i),n(0,s)},cancel:function(){n(5,d="month")}},duodecade:{component:Zt,next:function(){i.setFullYear(i.getFullYear()+10),n(1,i),n(0,s)},prev:function(){i.setFullYear(i.getFullYear()-10),n(1,i),n(0,s)},cancel:function(){n(5,d="year")}}};function p(){s&&"normal"===a&&n(1,i=new Date(s)),n(5,d="month"),r&&r()}function f(t,e){t.stopPropagation(),e?(n(1,i=new Date(e)),n(0,s=new Date(i))):(n(0,s=null),n(1,i=new Date)),"normal"===a&&p()}return t.$$set=t=>{"value"in t&&n(0,s=t.value),"current"in t&&n(1,i=t.current),"cancel"in t&&n(9,r=t.cancel),"part"in t&&n(2,a=t.part),"markers"in t&&n(3,c=t.markers),"buttons"in t&&n(4,l=t.buttons)},t.$$.update=()=>{3&t.$$.dirty&&n(1,i=i||s||new Date)},[s,i,a,c,l,d,o,u,f,r,function(t){d=t,n(5,d)},function(t){s=t,n(0,s)},function(t){i=t,n(1,i),n(0,s)},t=>f(t),t=>f(t,new Date)]}class ie extends yt{constructor(t){super(),bt(this,t,se,oe,f,{value:0,current:1,cancel:9,part:2,markers:3,buttons:4})}}function re(t){let e,n,o;const s=t[4].default,i=$(s,t,t[3],null);return{c(){e=C("div"),i&&i.c(),A(e,"class",n="wx-portal wx-"+t[0]+"-theme")},m(n,s){S(n,e,s),i&&i.m(e,null),t[5](e),o=!0},p(t,[r]){i&&i.p&&(!o||8&r)&&k(i,s,t,t[3],o?v(s,t[3],r,null):x(t[3]),null),(!o||1&r&&n!==(n="wx-portal wx-"+t[0]+"-theme"))&&A(e,"class",n)},i(t){o||(ut(i,t),o=!0)},o(t){pt(i,t),o=!1},d(n){n&&T(e),i&&i.d(n),t[5](null)}}}function ae(t,e,n){let o,{$$slots:s={},$$scope:i}=e,{theme:r=""}=e,{target:a=document.body}=e;return""===r&&(r=J("wx-theme")),W((()=>{a.appendChild(o)})),t.$$set=t=>{"theme"in t&&n(0,r=t.theme),"target"in t&&n(2,a=t.target),"$$scope"in t&&n(3,i=t.$$scope)},[r,o,a,i,s,function(t){Q[t?"unshift":"push"]((()=>{o=t,n(1,o)}))}]}class ce extends yt{constructor(t){super(),bt(this,t,ae,re,f,{theme:0,target:2})}}function le(t){let e,n;return{c(){e=new Y,n=M(),e.a=n},m(t,o){e.m("<style>\n@font-face {\nfont-family: 'Roboto';\nfont-style: normal;\nfont-weight: 400;\nsrc: local(''),\n    url('https://cdn.dhtmlx.com/fonts/roboto/regular.woff2') format('woff2'),\n    url('https://cdn.dhtmlx.com/fonts/roboto/regular.woff') format('woff');\n}\n@font-face {\nfont-family: 'Roboto';\nfont-style: normal;\nfont-weight: 500;\nsrc: local(''),\n    url('https://cdn.dhtmlx.com/fonts/roboto/500.woff2') format('woff2'),\n    url('https://cdn.dhtmlx.com/fonts/roboto/500.woff') format('woff');\n}</style>",t,o),S(t,n,o)},p:a,i:a,o:a,d(t){t&&T(n),t&&e.d()}}}class de extends yt{constructor(t){super(),bt(this,t,null,le,f,{})}}function ue(t){let e,n,o,s,i,r;return o=new de({}),{c(){e=C("link"),n=P(),vt(o.$$.fragment),s=P(),i=C("link"),A(e,"rel","preconnect"),A(e,"href","https://cdn.webix.com"),A(e,"crossorigin",""),A(i,"rel","stylesheet"),A(i,"href","https://cdn.dhtmlx.com/fonts/wxi/wx-icons.css")},m(t,a){S(t,e,a),S(t,n,a),kt(o,t,a),S(t,s,a),S(t,i,a),r=!0},i(t){r||(ut(o.$$.fragment,t),r=!0)},o(t){pt(o.$$.fragment,t),r=!1},d(t){t&&T(e),t&&T(n),xt(o,t),t&&T(s),t&&T(i)}}}function pe(t){let e,n,o,s=t[1]&&t[1].default&&function(t){let e,n;const o=t[3].default,s=$(o,t,t[2],null);return{c(){e=C("div"),s&&s.c(),A(e,"class","wx-material-theme"),R(e,"height","100%")},m(t,o){S(t,e,o),s&&s.m(e,null),n=!0},p(t,e){s&&s.p&&(!n||4&e)&&k(s,o,t,t[2],n?v(o,t[2],e,null):x(t[2]),null)},i(t){n||(ut(s,t),n=!0)},o(t){pt(s,t),n=!1},d(t){t&&T(e),s&&s.d(t)}}}(t),i=t[0]&&ue();return{c(){s&&s.c(),e=P(),i&&i.c(),n=M()},m(t,r){s&&s.m(t,r),S(t,e,r),i&&i.m(document.head,null),j(document.head,n),o=!0},p(t,[e]){t[1]&&t[1].default&&s.p(t,e),t[0]?i?1&e&&ut(i,1):(i=ue(),i.c(),ut(i,1),i.m(n.parentNode,n)):i&&(lt(),pt(i,1,1,(()=>{i=null})),dt())},i(t){o||(ut(s),ut(i),o=!0)},o(t){pt(s),pt(i),o=!1},d(t){s&&s.d(t),t&&T(e),i&&i.d(t),T(n)}}}function fe(t,e,n){let{$$slots:o={},$$scope:s}=e,{fonts:i=!0}=e;const r=e.$$slots;return V("wx-theme","material"),t.$$set=t=>{n(4,e=c(c({},e),w(t))),"fonts"in t&&n(0,i=t.fonts),"$$scope"in t&&n(2,s=t.$$scope)},e=w(e),[i,r,s,o]}class he extends yt{constructor(t){super(),bt(this,t,fe,pe,f,{fonts:0})}}const ge={core:{ok:"OK",cancel:"Cancel"},calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:7,timeFormat:24}};function $e(t){let e;const n=t[3].default,o=$(n,t,t[2],null);return{c(){o&&o.c()},m(t,n){o&&o.m(t,n),e=!0},p(t,[s]){o&&o.p&&(!e||4&s)&&k(o,n,t,t[2],e?v(n,t[2],s,null):x(t[2]),null)},i(t){e||(ut(o,t),e=!0)},o(t){pt(o,t),e=!1},d(t){o&&o.d(t)}}}function me(t,e,n){let{$$slots:o={},$$scope:s}=e,{words:i=null}=e,{optional:a=!1}=e,c=J("wx-i18n");return c||(c=r(ge)),c=c.extend(i,a),V("wx-i18n",c),t.$$set=t=>{"words"in t&&n(0,i=t.words),"optional"in t&&n(1,a=t.optional),"$$scope"in t&&n(2,s=t.$$scope)},[i,a,s,o]}class ve extends yt{constructor(t){super(),bt(this,t,me,$e,f,{words:0,optional:1})}}function ke(t){let e,n;const o=t[1].default,s=$(o,t,t[2],null);return{c(){e=C("div"),s&&s.c(),A(e,"class","wx-material-theme"),R(e,"height","100%"),R(e,"width","100%")},m(t,o){S(t,e,o),s&&s.m(e,null),n=!0},p(t,e){s&&s.p&&(!n||4&e)&&k(s,o,t,t[2],n?v(o,t[2],e,null):x(t[2]),null)},i(t){n||(ut(s,t),n=!0)},o(t){pt(s,t),n=!1},d(t){t&&T(e),s&&s.d(t)}}}function xe(t){let e,n,o=t[0]&&t[0].default&&function(t){let e,n;return e=new he({props:{$$slots:{default:[ke]},$$scope:{ctx:t}}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}(t);return{c(){o&&o.c(),e=M()},m(t,s){o&&o.m(t,s),S(t,e,s),n=!0},p(t,[e]){t[0]&&t[0].default&&o.p(t,e)},i(t){n||(ut(o),n=!0)},o(t){pt(o),n=!1},d(t){o&&o.d(t),t&&T(e)}}}function we(t,e,n){let{$$slots:o={},$$scope:s}=e;const i=e.$$slots;return t.$$set=t=>{n(3,e=c(c({},e),w(t))),"$$scope"in t&&n(2,s=t.$$scope)},e=w(e),[i,o,s]}class be extends yt{constructor(t){super(),bt(this,t,we,xe,f,{})}}const ye={core:{ok:"OK",cancel:"Cancel"},calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:7,timeFormat:24}};var _e={todo:{"No project":"No project","Search project":"Search project","Add project":"Add project","Rename project":"Rename project","Delete project":"Delete project","Add task below":"Add task below","Add subtask":"Add subtask","Set due date":"Set due date",Indent:"Indent",Unindent:"Unindent","Assign to":"Assign to","Move to":"Move to",Duplicate:"Duplicate",Copy:"Copy",Paste:"Paste",Delete:"Delete",Enter:"Enter",Tab:"Tab","Shift+Tab":"Shift+Tab","Ctrl+D":"Ctrl+D","Ctrl+C":"Ctrl+C","Ctrl+V":"Ctrl+V","CMD+D":"CMD+D","CMD+C":"CMD+C","CMD+V":"CMD+V","Type what you want":"Type what you want",Search:"Search","Add task":"Add task","New project":"New project"}};let je=(new Date).valueOf();const Se=()=>je++;class Te{constructor(t,e,n){this._setter=t,this._routes=e,this._parsers=n,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach((t=>{t.in.forEach((e=>{const n=this._triggers.get(e)||[];n.push(t),this._triggers.set(e,n)})),t.out.forEach((e=>{const n=this._sources.get(e)||{};t.in.forEach((t=>n[t]=!0)),this._sources.set(e,n)}))})),this._routes.forEach((t=>{t.length=Math.max(...t.in.map((t=>De(t,this._sources,1))))}))}init(t){const e={};for(const n in t)if(this._prev[n]!==t[n]){const o=this._parsers[n];e[n]=o?o(t[n]):t[n]}this._prev=this._prev?{...this._prev,...t}:{...t},this.setState(e)}setState(t,e){this._setter(t);const n=!e;e=e||[];for(const n in t){const t=this._triggers.get(n);t&&t.forEach((t=>{-1==e.indexOf(t)&&e.push(t)}))}n&&this._execNext(e)}_execNext(t){for(;t.length;){t.sort(((t,e)=>t.length<e.length?1:-1));const e=t[t.length-1];t.splice(t.length-1),e.exec(t)}}}function De(t,e,n){const o=e.get(t);if(!o)return n;const s=Object.keys(o).map((t=>De(t,e,n+1)));return Math.max(...s)}class Ce{constructor(){this._nextHandler=()=>null,this._handlers={},this.exec=this.exec.bind(this)}on(t,e){const n=this._handlers[t];this._handlers[t]=n?function(t){Ie(n,t)(e(t))}:n=>{Ie(this._nextHandler,n,t)(e(n))}}exec(t,e){const n=this._handlers[t];n?n(e):this._nextHandler(t,e)}setNext(t){this._nextHandler=t}}function Ie(t,e,n){return o=>{!1!==o&&(o&&o.then?o.then(Ie(t,e,n)):n?t(n,e):t(e))}}class Pe{constructor(t){this._nextHandler=()=>null,this._dispatch=t,this.exec=this.exec.bind(this)}exec(t,e){this._dispatch(t,e),this._nextHandler&&this._nextHandler(t,e)}setNext(t){this._nextHandler=t}}let Me=(new Date).valueOf();function Ne(){return Me+=1,"temp://"+Me}function Ee(t,e){return t==e}function Ae(t){return null!=t}function Fe(t){return null===t}function Oe(t,e){const n=t.length;for(let o=0;o<n;o++)if(e(t[o]))return o;return-1}function Re(t){return/\s/g.test(t)}const Le=(t,e)=>t.map((t=>(t?.label&&(t.label=e(t.label)),t?.items&&Le(t.items,e),t))),Ye=t=>{const e={},n=["monthShort","monthFull","dayShort","dayFull"];for(const o of n)e[o]=t(o);return e};function ze(){return navigator.userAgent.indexOf("Mac")>-1}function Be(t,e,n){const o=e.filter((e=>e.label.includes(n(t))));if(!o.length)return n(t);const s=new RegExp(/(?<=\()[\d]+(?=\))/g);let i=0;for(const{label:t}of o){const e=t.match(s);e&&+e[0]>i&&(i=+e[0])}return`${n(t)} (${i+1})`}function He(t){if(!t)return t;const e=Array.isArray(t)?[]:{};for(const n in t){const o=t[n];o instanceof Date?e[n]=new Date(o):e[n]="object"==typeof o?He(o):o}return e}function We(t){return t.flatMap((({children:t,...e})=>[e,...We(t||[])]))}const Ge=["#607D8B","#00C7B5","#03A9F4","#9575CD","#F06292","#FF9800"],Ve={counter:{type:"number"},date:{format:"%d %M %Y",validate:!0},selectable:{behavior:"auto"}},Je=t=>new RegExp(String.raw`(?<=^|\s)${t}(?=\s|$)`,"gm"),Ue=t=>new RegExp(String.raw`(?<= |^)${t}\S+`,"gm");function qe(t,e,n){if(n){const n=Je(e);return!!t.match(n)?.length}return t.toLowerCase().includes(e.toLowerCase())}function Qe(t=[],e){return t.map((t=>({...t,children:Qe(t.children,e)}))).filter((t=>function(t,{match:e,by:n,strict:o}){return qe(n?t[n]||"":t.text||"",e,o)}(t,e)||t?.children?.length))}function Ke(t){return We(function(t){const e={},n=[],o={};for(let n=0;n<t.length;n++)o[t[n].id]=n,e[t[n].id]=[],t[n].children=[];for(let s=0;s<t.length;s++){const i=t[s];i.parent&&e[i.parent]?(t[o[i.parent]].children.push(i),e[i.parent].push(i)):Ae(i.parent)||n.push(i)}return n}(t))}function Xe(t,e,n){if(t?.children?.length)for(let o=0;o<t.children.length;o++)Xe(t.children[o],e,n);t.counter={type:n?.counter?.type||"number",total:e[t.id].length,done:e[t.id].filter((t=>!0===t.checked)).length}}function Ze(t,e){const n=[];for(let o=0;o<e.assigned.length;o++){const s=e.assigned[o];t[s]&&n.push(t[s])}return n}function tn(t){const{menu:e,editableItem:n,stateDueDate:o}=t.getState();e?.open&&t.in.exec("close-menu",{...e}),n&&t.in.exec("close-inline-editor",{id:n.id,save:!0}),o?.open&&t.in.exec("set-state-due-date",{...o,open:!1})}function en(t,{id:e,project:n,parent:o,targetId:s,task:i={},reverse:r}){i.id=e||i.id||Ne().toString(),i.project=Fe(n)?n:n||i.project||t.getState()?.activeProject,i.parent=Fe(o)?o:o||i.parent;let{tasks:a}=t.getState();a=[...a,i];const{treeTasks:c,children:l,filteredChildren:d,usersMap:u,tags:p}=t.getInnerState(a,t.getState().activeProject);t.setState({tasks:a,treeTasks:c,children:l,filteredChildren:d,usersMap:u,tags:p}),(Ae(s)||r)&&t.moveTask({id:i.id,parent:i.parent,project:i.project,targetId:s,reverse:r,silent:!0})}function nn(t,{id:e,task:n,skipStateCalc:o=!1}){t.updateTask({id:e,task:n,skipStateCalc:o})}function on(t,{id:e,parent:n,targetId:o,reverse:s,project:i}){tn(t),t.moveTask({id:e,parent:n,targetId:o,reverse:s,project:i})}function sn(t,{id:e,targetId:n,parent:o,reverse:s,project:i}){if(!t.existsTask(e))return;const r=[],a=t.getTask(e),c=(e,n)=>{const o=He(t.getTask(e)),s=t.getChildren({id:e});if(o.id=Ne().toString(),o.parent=n,r.push(o),s.length)for(let t=0;t<s.length;t++)c(s[t].id,o.id)};c(e,a.parent),t.setState({copiedTasks:r}),(t.existsTask(n)||t.existsTask(o)||Fe(o))&&t.pasteTask({targetId:n,parent:o,project:i,reverse:s,clone:!1})}function rn(t,{targetId:e,parent:n,project:o,reverse:s}){t.pasteTask({targetId:e,parent:n,project:o,reverse:s})}function an(t,{id:e}){if(!t.existsTask(e))return;const n=t.getState(),o=t.getChildren({id:e,tree:!0}),s=[e];for(let t=0;t<o.length;t++)s.push(o[t].id);const i=n.tasks.filter((t=>!s.some((e=>Ee(e,t.id))))),{treeTasks:r,children:a,filteredChildren:c,usersMap:l,tags:d}=t.getInnerState(i,n.activeProject);t.setState({tasks:i,treeTasks:r,children:a,filteredChildren:c,usersMap:l,tags:d})}function cn(t,{id:e}){const n=t.getTask(e);n?.collapsed&&t.in.exec("update-task",{id:e,task:{...n,collapsed:!1},skipProvider:!0})}function ln(t,{id:e}){const n=t.getTask(e);n?.collapsed||t.in.exec("update-task",{id:e,task:{...n,collapsed:!0},skipProvider:!0})}function dn(t,{id:e,manual:n=!1,skipStateCalc:o=!1}){const s=t.getTask(e);if(s?.checked)return;const i=[],r=t.getState().taskShape?.selectable?.behavior||"auto";if(!n&&"manual"!==r&&!o){t.hasChildren(e)&&t.getChildren({id:e,tree:!0}).forEach((e=>{e.checked||(t.in.exec("check-task",{id:e.id,skipStateCalc:!0}),i.push(t.getTask(e.id)))}));const n=t.getParentIds(e);n.forEach((o=>{if(t.getChildren({id:o}).every((t=>!(!Ee(t.id,e)&&!n.includes(t.id))||t.checked))){t.getTask(o).checked||(t.in.exec("check-task",{id:o,skipStateCalc:!0}),i.push(t.getTask(o)))}}))}t.in.exec("update-task",{id:e,task:{...s,checked:!0},skipStateCalc:o,skipProvider:o&&!n,bunch:i})}function un(t,{id:e,manual:n=!1,skipStateCalc:o=!1}){const s=t.getTask(e);if(!s?.checked)return;const i=[],r=t.getState().taskShape?.selectable?.behavior||"auto";n||"manual"===r||o||(Ae(s.parent)&&t.getParentIds(e).forEach((e=>{t.getTask(e).checked&&(t.in.exec("uncheck-task",{id:e,skipStateCalc:!0}),i.push(t.getTask(e)))})),t.hasChildren(e)&&t.getChildren({id:e,tree:!0}).forEach((e=>{e.checked&&(t.in.exec("uncheck-task",{id:e.id,skipStateCalc:!0}),i.push(t.getTask(e.id)))}))),t.in.exec("update-task",{id:e,task:{...s,checked:!1},skipStateCalc:o,skipProvider:o&&!n,bunch:i})}function pn(t,{id:e}){const n=t.getTask(e),o=t.getTask(n?.parent),s=t.getChildren({id:o?.id,tree:!1}),i=t.getTreeIndex(e);if(i>0){const n=t.getTask(s[i-1]?.id);t.in.exec("move-task",{id:e,parent:n?.id,targetId:t.getTailId(n.id),operation:"indent"}),n.collapsed&&t.in.exec("expand-task",{id:n?.id})}}function fn(t,{id:e}){const n=t.getTask(e),o=t.getTask(n?.parent);if(!Ae(o))return;const s=t.getChildren({id:o?.id,tree:!1}),i=t.getTreeIndex(e);let r=o.id;s.length-1===i?r=t.getNearId({id:e,dir:"prev"}):t.getChildren({id:e}).length&&(r=t.getNearId({id:t.getTailId(e)})),Ae(r)&&t.in.exec("move-task",{id:e,parent:void 0===o.parent?null:o.parent,targetId:r,operation:"unindent"})}function hn(t,{id:e}){const{selected:n}=t.getState();Ee(e,n)||(Ae(n)&&t.in.exec("unselect-task",{id:n}),t.setState({selected:e}))}function gn(t,{id:e}){t.existsTask(e)&&(tn(t),t.setState({selected:null}))}function $n(t,{id:e,project:n}){n={id:e||Se().toString(),label:"New project",...n};const o=[...t.getState().projects,n];t.setState({projects:o})}function mn(t,{id:e,project:n}){if(!t.existsProject(e))return;const o=t.getState().projects.map((t=>Ee(e,t.id)?{...t,...n}:t));t.setState({projects:o})}function vn(t,{id:e}){tn(t);const{treeTasks:n,children:o,filteredChildren:s}=t.getInnerState(t.getState().tasks,e);t.setState({activeProject:e,treeTasks:n,children:o,filteredChildren:s})}function kn(t,{id:e}){if(!t.existsProject(e))return;const n=t.getState(),o=n.projects.filter((t=>!Ee(t.id,e)));n.tasks.forEach((n=>(Ee(n.project,e)&&t.in.exec("update-task",{id:n.id,task:{...n,project:null},skipProvider:!0,skipStateCalc:!0}),n))),Ee(n.activeProject,e)&&t.in.exec("set-project",{id:null});const s=n.tasks,{treeTasks:i,children:r,filteredChildren:a}=t.getInnerState(s,n?.activeProject);t.setState({projects:o,treeTasks:i,tasks:s,children:r,filteredChildren:a})}function xn(t,e,n){switch(n){case"task":return function(t,e){const{filter:n,projects:o,users:s}=t.getState(),i=[];Ae(n)||i.push({icon:"plus",label:"Add task below",hotkey:"Enter",id:"addBellow"},{icon:"subtask",label:"Add subtask",id:"addSubtask"},{type:"separator"});i.push({icon:"indent",label:"Indent",hotkey:"Tab",id:"indent"},{icon:"unindent",label:"Unindent",hotkey:"Shift+Tab",id:"unindent"},{icon:"calendar",label:"Set due date",id:"dueDate"}),s?.length&&i.push({icon:"assign",label:"Assign to",items:wn(t,e),id:"assign"});o?.length&&i.push({icon:"content-paste",label:"Move to",items:bn(t),id:"moveProject"});return[...i,{icon:"duplicate",label:"Duplicate",hotkey:ze()?"CMD+D":"Ctrl+D",id:"duplicate"},{icon:"content-copy",label:"Copy",hotkey:ze()?"CMD+C":"Ctrl+C",id:"copy"},{icon:"paste",label:"Paste",hotkey:ze()?"CMD+V":"Ctrl+V",id:"paste"},{type:"separator"},{icon:"delete",label:"Delete",hotkey:"Delete",id:"delete"}]}(t,e);case"user":return[];case"project":return function(t){const e=[{id:"add",icon:"plus",label:"Add project"}];Ae(t)&&e.push({id:"rename",icon:"edit",label:"Rename project"},{id:"delete",icon:"delete",label:"Delete project"});return e}(e)}}function wn(t,e){const n=He(t.getState().users),o=[],s=t.getTask(e);if(n.length)for(let t=0;t<n.length;t++){const e=n[t];e.color=e.color||Ge[t%Ge.length],e.checked=s?.assigned?.includes(e.id),o.push(e)}return o}function bn(t){const e=t.getState().activeProject;let n=He(t.getState().projects);n.every((t=>Ae(t.id)))&&(n=[{id:null,label:"No project"},...n]);const o=[];if(n.length)for(let t=0;t<n.length;t++){const s=n[t];s.type="project",s.checked=Ee(s.id,e),o.push(s)}return o}function yn(t,{id:e,coords:n,context:o,type:s}){Ae(s)&&("project"!==s&&t.existsTask(e)||"project"===s&&(t.existsProject(e)||!Ae(e)))&&t.setState({menu:{id:e,type:s,open:!0,context:o,data:xn(t,e,s),coords:n}})}function _n(t){t.setState({menu:{id:null,type:null,open:!1,data:[],context:!1,coords:null}})}function jn(t,e,n=!1){const o=Ne().toString();t.in.exec("add-task",{id:o,targetId:e.id,parent:e?.parent,project:t.getState()?.activeProject,reverse:n}),t.in.exec("select-task",{id:o}),t.in.exec("open-inline-editor",{id:o,type:"task"})}function Sn(t,e){t.existsTask(e)&&(t.in.exec("select-task",{id:Tn(t,e)}),t.in.exec("delete-task",{id:e}))}function Tn(t,e){const n=t.getTask(e),o=t.getChildrenIds({id:n?.parent,tree:!1});let s;return s=(!Ae(n?.parent)||1!==o.length&&o[o.length-1]!==n.id)&&t.getNearId({id:n.id,flat:!0})||t.getNearId({id:n.id,dir:"prev",flat:!0}),s}function Dn(t,{id:e,action:n,extra:o}){const s=t.getTask(e);switch(n){case"addBellow":jn(t,s);break;case"addSubtask":jn(t,{...s,parent:e,targetId:e}),s?.collapsed&&t.hasChildren(e)&&t.in.exec("expand-task",{id:e});break;case"duplicate":t.in.exec("copy-task",{id:e,targetId:t.getTailId(s?.id)});break;case"delete":Sn(t,s.id);break;case"indent":t.in.exec("indent-task",{id:e});break;case"unindent":t.in.exec("unindent-task",{id:e});break;case"copy":t.in.exec("copy-task",{id:e});break;case"paste":t.in.exec("paste-task",{targetId:t.getTailId(e),parent:Ae(s?.parent)?s?.parent:null});break;case"assign":s?.assigned?.includes(o)?t.in.exec("unassign-user",{id:e,userId:o}):t.in.exec("assign-user",{id:e,userId:o}),t.setState({menu:{...t.getState().menu,data:xn(t,e,"task")}});break;case"moveProject":!function(t,e,n){Ee(e,t.getTask(n)?.project)||void 0===e||(t.in.exec("select-task",{id:Tn(t,n)}),t.in.exec("move-task",{id:n,project:e,parent:null,operation:"project"}))}(t,o,e);break;case"dueDate":t.in.exec("set-state-due-date",{id:e,value:s?.due_date,open:!0}),t.in.exec("close-menu",{...t.getState().menu})}}function Cn(t,{id:e,userId:n}){const o=t.getTask(e);o?.assigned?.includes(n)||t.in.exec("update-task",{id:e,task:{...o,assigned:o?.assigned?.length?[...o.assigned,n]:[n]}})}function In(t,{id:e,userId:n}){const o=t.getTask(e);o?.assigned?.includes(n)&&t.in.exec("update-task",{id:e,task:{...o,assigned:o?.assigned?.filter((t=>t!=n))}})}function Pn(t,{id:e,type:n="task",targetDate:o}){if(!Ae(e)||!t.existsTask(e)&&"task"===n||!t.existsProject(e)&&"project"===n)return;let s=null;"task"===n?s=t.getTask(e)?.text:"project"===n&&(s=t.getState()?.projects?.find((t=>Ee(e,t.id)))?.label),t.setState({editableItem:{id:e,type:n,initValue:s,currentValue:s,targetDate:o}})}function Mn(t,{id:e,save:n=!0}){const{editableItem:o}=t.getState();if(!Ae(o?.id))return;e=o.id;const s=o.currentValue;n&&("task"===o.type&&t.in.exec("update-task",{id:e,task:{...t.getTask(e),text:s}}),"project"===o.type&&t.in.exec("update-project",{id:e,project:{...t.getProject(e),label:s}})),t.setState({editableItem:null})}function Nn(t,{currentValue:e,dropdown:n,targetDate:o}){const{editableItem:s}=t.getState();t.setState({editableItem:{...s,currentValue:e,dropdown:n,targetDate:o}})}function En(t,e="data-id"){let n=t;if(t?.changedTouches){const{clientX:e,clientY:o}=t.changedTouches[0];n=document.elementFromPoint(e,o)}else!t.tagName&&t.target&&(n=t.target);for(;n;){if(n.getAttribute){if(n.getAttribute(e))return n}n=n.parentNode}return null}function An(t,e="data-id"){const n=En(t,e);return n?function(t,e="data-id"){const n=t.getAttribute(e),o=parseInt(n);return isNaN(o)||o.toString()!=n?n:o}(n,e):null}function Fn(t,e){if(t){if(t?.childNodes[0]){const n=document.createRange(),o=window.getSelection();let s=t?.childNodes[t?.childNodes.length-1];const i=s?.textContent?.length;let r=i;if("number"==typeof e){const n=t.childNodes;for(let t=0;t<n.length;t++){const o=n[t],i=o.textContent.length;if(i>=e){r=e,s=o;break}e-=i}}n.setStart(s,r),n.collapse(!0),o.removeAllRanges(),o.addRange(n)}setTimeout((()=>t.focus()))}}function On({clientX:t,clientY:e}){return{x:t,y:e}}function Rn(t,{code:e,event:n}){const{selected:o,editableItem:s,filter:i,stateSearch:r,menu:a,stateDueDate:c}=t.getState(),l=Ae(s?.id);if(Ae(o)&&!r?.focus&&function(t,e,n){const{selected:o,editableItem:s,readonly:i,filter:r}=t.getState(),a=t.getTask(o),c=Ae(s?.id);if(s?.dropdown)return;if(!i)switch(e){case"ctrl+arrowup":!function(t,e){const{treeTasks:n,selected:o,filter:s}=t.getState(),i=Ae(s),r=t.getNearId({id:o,dir:"prev",flat:!0,filtered:i}),a=t.getTask(r),c=t.getTask(e);!Ee(n[0].id,o)&&Ee(a?.parent,c?.parent)&&t.in.exec("move-task",{id:o,targetId:r,parent:c?.parent,reverse:!0})}(t,o);break;case"ctrl+arrowdown":!function(t,e){const{treeTasks:n,selected:o,filter:s}=t.getState(),i=Ae(s),r=t.getNearId({id:o,flat:!0,filtered:i}),a=t.getTask(r),c=t.getTask(e);!Ee(n[n.length-1].id,o)&&Ee(a?.parent,c?.parent)&&t.in.exec("move-task",{id:o,parent:c?.parent,targetId:t.getTailId(r,i)})}(t,o);break;case"tab":t.in.exec("indent-task",{id:o});break;case"shift+tab":t.in.exec("unindent-task",{id:o});break;case"delete":case"backspace":c||Sn(t,o);break;case"enter":c&&Ae(a?.parent)&&!s?.currentValue?.length?t.in.exec("unindent-task",{id:o}):c?t.in.exec("close-inline-editor",{id:s.id}):Ae(r)||(n.preventDefault(),jn(t,a));break;case"ctrl+enter":!c&&t.in.exec("open-inline-editor",{id:o,type:"task"});break;case"ctrl+d":n.preventDefault(),t.in.exec("copy-task",{id:o,targetId:t.getTailId(o)});break;case"ctrl+c":!window.getSelection().toString()?.length&&t.in.exec("copy-task",{id:o});break;case"ctrl+v":!c&&t.in.exec("paste-task",{targetId:t.getTailId(o),parent:Ae(a?.parent)?a?.parent:null})}switch(e){case"arrowup":Ln(t,"up");break;case"arrowdown":Ln(t,"down");break;case"arrowleft":Ln(t,"left");break;case"arrowright":Ln(t,"right");break;case"space":c||(n.preventDefault(),a?.checked?t.in.exec("uncheck-task",{id:o}):t.in.exec("check-task",{id:o}))}}(t,e,n),"escape"===e)a?.open?t.in.exec("close-menu",{...a}):l?t.in.exec("close-inline-editor",{...s,save:!1}):c?.open?t.in.exec("set-state-due-date",{...c,open:!1}):(i&&t.in.exec("set-filter",{match:null}),r?.open&&t.in.exec("set-state-search",{...r,value:null,open:!1}))}function Ln(t,e){const{selected:n,treeTasks:o,editableItem:s,filter:i}=t.getState();if(Ae(s?.id))return;if(!Ae(n))return void t.in.exec("select-task",{id:o[0]?.id});const r=t.getTask(n),a=Ae(i);let c;switch(e){case"up":c=t.getNearId({id:n,dir:"prev",filtered:a});break;case"down":c=t.getNearId({id:n,filtered:a});break;case"left":t.hasChildren(r.id,a)&&!r.collapsed?t.in.exec("collapse-task",{id:r.id}):c=r?.parent;break;case"right":t.hasChildren(r.id,a)&&r.collapsed&&t.in.exec("expand-task",{id:r.id})}Ae(c)&&t.in.exec("select-task",{id:c})}function Yn(t,e){const n=t.getState(),o="string"==typeof e?.match?e.match.trim():null;let s={match:o,by:"string"==typeof e?.by?e.by.trim():null,...e};Ae(o)&&o?.length||(s=null),(Ae(n.filter)||Ae(s))&&t.setState({filter:s})}function zn(t,{value:e,open:n,dropdown:o,focus:s}){const i=t.getState().stateSearch;t.setState({stateSearch:{value:e,open:Ae(n)?n:i?.open,dropdown:Ae(o)?o:i?.dropdown,focus:Ae(s)?s:i?.focus}})}function Bn(t,{open:e,value:n,id:o}){const s=t.getTask(o);t.setState({stateDueDate:{id:o,open:e,value:n}}),s?.due_date===n&&Ae(n)||t.in.exec("update-task",{id:o,task:{...s,due_date:new Date(n)}})}class Hn extends class{constructor(t){this._writable=t,this._values={},this._state={}}setState(t){const e=this._state;for(const n in t)e[n]?e[n].set(t[n]):this._state[n]=this._wrapWritable(n,t[n])}getState(){return this._values}getReactive(){return this._state}_wrapWritable(t,e){const n=this._writable(e);return n.subscribe((e=>{this._values[t]=e})),n}}{constructor(t){super(t),this.in=new Ce,this.out=new Ce,this.in.setNext(this.out.exec),this._router=new Te(super.setState.bind(this),[],{});const e={"add-task":en,"update-task":nn,"move-task":on,"copy-task":sn,"paste-task":rn,"delete-task":an,"expand-task":cn,"collapse-task":ln,"check-task":dn,"uncheck-task":un,"indent-task":pn,"unindent-task":fn,"add-project":$n,"update-project":mn,"set-project":vn,"delete-project":kn,"select-task":hn,"unselect-task":gn,"open-menu":yn,"close-menu":_n,"click-menu-item":Dn,"assign-user":Cn,"unassign-user":In,"open-inline-editor":Pn,"close-inline-editor":Mn,"edit-item":Nn,"keypress-on-todo":Rn,"set-filter":Yn,"set-state-search":zn,"set-state-due-date":Bn};this.in.on("set-filter",(()=>{const{tasks:t,activeProject:e,filter:n}=this.getState(),{treeTasks:o,children:s,filteredChildren:i,tags:r}=this.getInnerState(t,e);n?.match&&tn(this),this.setState({treeTasks:o,children:s,filteredChildren:i,tags:r})})),this._setHandlers(e)}init(t){if(this._router.init({id:null,selected:null,readonly:!1,taskShape:Ve,projects:[],tasks:[],users:[],tags:[],treeTasks:[],copiedTasks:[],usersMap:null,children:null,defaultTags:[],filteredChildren:null,editableItem:null,stateSearch:null,stateDueDate:null,filter:null,menu:{id:null,type:null,open:!1,data:[],coords:{x:null,y:null}},...t}),t.tags.length){const e=t.tags.map((t=>t.startsWith("#")?t:`#${t}`));this.setState({defaultTags:[...new Set(e)]})}const e=Ke(t.tasks).map((t=>{const e=t.id||Se().toString();return{...t,id:e}}));let n=t.activeProject;void 0!==t.activeProject||e.some((t=>!Ae(t.project)&&!Ae(t.parent)))||(n=t.projects[0]?.id||null);const{treeTasks:o,children:s,filteredChildren:i,usersMap:r,tags:a}=this.getInnerState(e,n);this.setState({tasks:e,treeTasks:o,children:s,usersMap:r,filteredChildren:i,tags:a,activeProject:n})}setState(t,e){this._router.setState(t,e)}serialize(){const{tasks:t,projects:e,users:n,tags:o,activeProject:s}=this.getState();return{tasks:[...t],projects:[...e],users:[...n],tags:[...o],activeProject:s}}parse(t){const e=this.getState();t?.tasks&&(t.tasks=Ke(t.tasks));const n=t?.tasks||e.tasks,o=t?.projects||e.projects,s=t?.users||e.users;let i=e.activeProject||null;if((t?.projects?.length&&o.find((e=>Ee(e?.id,t?.activeProject)))||null===t?.activeProject)&&(i=t.activeProject),t?.tags){const e=(t.tags||[]).map((t=>t.startsWith("#")?t:`#${t}`));this.setState({defaultTags:[...new Set(e)]})}const{treeTasks:r,children:a,filteredChildren:c,usersMap:l,tags:d}=this.getInnerState(n,i);this.setState({treeTasks:r,children:a,filteredChildren:c,usersMap:l,tags:d,tasks:n,projects:o,users:s,activeProject:i})}existsTask(t){return Ae(this.getState().children[t?.toString()])}existsProject(t){return Ae(this.getState().projects.find((e=>Ee(e.id,t)))?.id)}updateTask({id:t,task:e,skipStateCalc:n=!1}){if(!this.existsTask(t))return;const o=this.getState(),s=o.tasks.map((n=>Ee(t,n.id)?{...n,...e}:n));if(n)return void this.setState({tasks:s});const{treeTasks:i,children:r,filteredChildren:a,usersMap:c,tags:l}=this.getInnerState(s,o.activeProject);this.setState({tasks:s,treeTasks:i,children:r,filteredChildren:a,usersMap:c,tags:l})}moveTask({id:t,project:e,parent:n,targetId:o,reverse:s,silent:i=!1}){if(!this.existsTask(t)||Ee(t,n)||Ee(t,o))return;const r=this.getState(),a=this.getTask(t),c=this.existsTask(n),l=this.existsTask(o);a.parent=c||Fe(n)?n:null,Fe(e)||this.existsProject(e)?a.project=e:a.project=l?this.getTask(o).project:c?this.getTask(n).project:r?.activeProject,i?this.updateTask({id:t,task:a}):this.in.exec("update-task",{id:t,task:a,skipProvider:!0,skipStateCalc:!0});const d=this.getChildren({id:t,tree:!0}),u=d.length;if(void 0!==e&&this.hasChildren(t))for(let t=0;t<u;t++){const e=d[t];"project"in e&&(i?this.updateTask({id:e.id,task:{...this.getTask(e.id),project:a.project}}):this.in.exec("update-task",{id:e.id,task:{...this.getTask(e.id),project:a.project},skipProvider:!0,skipStateCalc:!0}))}const p=r.tasks,f=p.findIndex((e=>Ee(e.id,t))),h=p.splice(f,u+1);let g=s?0:r.tasks.length+1;if(c&&!Ae(o)){const e=this.getChildrenIds({id:n,tree:!0}),o=e.length,i=o?s?e[0]:e[o-1]:n;g=Ee(t,i)?f:p.findIndex((t=>Ee(t.id,i)))+(s?0:1)}if(l)if(s){if(Ee(n,o)){const e=this.getChildrenIds({id:o});e.length&&!Ee(t,e[0])&&(o=e[0])}g=p.findIndex((t=>Ee(t.id,o)))}else{const e=this.getChildrenIds({id:o,tree:!0}),n=e.length;let s=n&&!e.includes(t)?e[n-1]:o;Ee(s,t)&&(s=o),g=p.findIndex((t=>Ee(t.id,s)))+1}p.splice(g,0,...h);const{treeTasks:$,children:m,filteredChildren:v,usersMap:k}=this.getInnerState(p,r.activeProject);this.setState({tasks:p,treeTasks:$,children:m,filteredChildren:v,usersMap:k})}pasteTask({targetId:t,parent:e,project:n,reverse:o,clone:s=!0}){const{copiedTasks:i}=this.getState();let r=[...i];if(s){r=[];const t={};for(let e=0;e<i.length;e++){const n=Ne().toString(),o=He(i[e]);t[o.id]=n,o.id=n,r.push(o)}for(let e=0;e<r.length;e++){const n=r[e];n.parent=t[n.parent]}}for(let s=0;s<r.length;s++){const i=r[s];0===s?this.in.exec("add-task",{task:i,id:i.id,parent:e,targetId:t,reverse:o,project:n,skipProvider:!0}):this.in.exec("add-task",{task:i,id:i.id,parent:i.parent,targetId:r[s-1]?.id,project:n,skipProvider:!0})}r.length&&this.in.exec("clone-task",{parent:e,targetId:t,project:n,bunch:r})}getTask(t){return this.getState().tasks.find((e=>Ee(e.id,t)))}getProject(t){return this.getState().projects.find((e=>Ee(e.id,t)))}getChildren({id:t,tree:e=!1,filtered:n=!1}){if(!this.existsTask(t)&&Ae(t))return;let o=[];if(!Ae(t))return this.getState().treeTasks;const s=this.getState()[n?"filteredChildren":"children"][t];if(o=[...o,...s],e)for(let t=0;t<s.length;t++){const e=s[t];e?.children?.length&&(o=[...o,...this.getChildren({id:e.id,tree:!0,filtered:n})])}return o}getChildrenIds({id:t,tree:e=!0,filtered:n=!1}){if(!this.existsTask(t)&&Ae(t))return null;let o=[];const s=this.getChildren({id:t,tree:!1,filtered:n});for(let t=0;t<s.length;t++){const i=s[t];o.push(i.id),i?.children?.length&&e&&(o=[...o,...this.getChildrenIds({id:i.id,tree:e,filtered:n})])}return o}getTailId(t,e=!1){const n=this.getChildrenIds({id:t,filtered:e});return n.length?n[n.length-1]:t}hasChildren(t,e){return!!this.getState()[e?"filteredChildren":"children"][t]?.length}getTreeIndex(t,e=!1){const n=this.getTask(t);return this.getChildren({id:n?.parent,filtered:e}).findIndex((e=>Ee(e.id,t)))}getParentIds(t){if(!this.existsTask(t))return;const e=[],n=this.getTask(t)?.parent;return this.existsTask(n)&&e.push(n,...this.getParentIds(n)),e}getNearId({id:t,dir:e="next",flat:n=!1,filtered:o=!1}){if(this.existsTask(t))return"next"===e?this._getNextId(t,n,!1,o):this._getPrevId(t,n,o)}getInnerState(t,e){const{users:n,filter:o,taskShape:s,defaultTags:i}=this.getState(),r=function(t){const e={};t=He(t);for(let n=0;n<t.length;n++){const o=t[n];o.color=o.color||Ge[n%Ge.length],e[o.id]=o}return e}(n),a=He(t),c=new Set(i),l={},d={};let u={},p=[];for(let t=0;t<a.length;t++){const e=a[t];if(e?.assigned?.length&&(e.availableUsers=Ze(r,e)),l[a[t].id]=t,a[t].children=[],d[e.id]=[],e.text){const t=e.text.matchAll(Ue("#"));for(const e of t)c.add(e[0])}}for(let t=0;t<a.length;t++){const e=a[t];e.parent&&d[e.parent]?(a[l[e.parent]].children.push(e),d[e.parent].push(e)):Ae(e.parent)||p.push(e)}p=p.filter((t=>Ee(t.project,e))),Ae(o)&&(p=Qe(p,o),u=function(t){const e={},n=t=>{for(let o=0;o<t.length;o++){const s=t[o];e[s.id]||(e[s.id]=[...s?.children]),s?.children?.length&&n(s.children)}};return n(t),e}(p));for(let t=0;t<p.length;t++)Xe(p[t],d,s);return{treeTasks:p,children:d,usersMap:r,filteredChildren:u,tags:[...c]}}_setHandlers(t){Object.keys(t).forEach((e=>{this.in.on(e,(n=>t[e](this,n)))}))}_getNextId(t,e=!1,n=!1,o=!1){const s=this.getTask(t),i=this.hasChildren(t,o);if(e||!i||s.collapsed||n){const n=this.getTask(s?.parent)?.id,i=this.getChildren({id:n,filtered:o}),r=Oe(i,(e=>Ee(e.id,t)));return r+1<i.length?i[r+1]?.id:Ae(n)?this._getNextId(n,e,!0,o):null}return this.getChildren({id:t,filtered:o})[0]?.id}_getPrevId(t,e=!1,n=!1){const o=this.getTreeIndex(t,n),s=this.getTask(t)?.parent;if(o>0){let t=this.getChildren({id:s,filtered:n})[o-1];if(!this.hasChildren(t.id,n)||t.collapsed)return t.id;for(;!e&&this.hasChildren(t.id,n)&&!t.collapsed;){const e=this.getChildren({id:t.id,filtered:n});t=e[e.length-1]}return t.id}return Ae(s)?s:null}}function Wn(t,e){return t.filter((t=>t.includes(e))).map((t=>({label:t,id:t})))}function Gn(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return t.replace(/[&<>"']/g,(t=>e[t]))}function Vn(t,e){if(!t)return"";let n=Gn(t);return e?.highlight?n=function(t,e){const n=e?.strict?Je(e.match):new RegExp(e.match,"gi"),o=e?.strict?"wx-todo_filter--strict":"wx-todo_filter";return t.replace(n,(t=>`<mark class="${o}">${t}</mark>`))}(n,e):(n=function(t){return t.replace(Ue("#"),(t=>`<span class="wx-todo_tag" data-tag="${t}">${t}</span>`))}(n),n=function(t){const e=new RegExp(/!\((.+?)\)/gm);return t.replace(e,(t=>{const e=t.substring(2,t.length-1);return`<span class="wx-todo_date" data-date="${e}">${e}</span>`}))}(n)),n}let Jn=null;const Un={"%d":t=>{const e=t.getDate();return e<10?"0"+e:e},"%j":t=>t.getDate(),"%l":t=>Jn.dayFull[t.getDay()],"%D":t=>Jn.dayShort[t.getDay()],"%m":t=>{const e=t.getMonth()+1;return e<10?"0"+e:e},"%n":t=>t.getMonth()+1,"%M":t=>Jn.monthShort[t.getMonth()],"%F":t=>Jn.monthFull[t.getMonth()],"%y":t=>t.getFullYear().toString().slice(2),"%Y":t=>t.getFullYear()},qn={"%d":(t,e)=>{/(^([0-9][0-9])$)/i.test(e)?t.setDate(Number(e)):t.setDate(Number(1))},"%j":(t,e)=>{/(^([0-9]?[0-9])$)/i.test(e)?t.setDate(Number(e)):t.setDate(Number(1))},"%m":(t,e)=>{const n=/(^([0-9][0-9])$)/i.test(e);n?t.setMonth(Number(e)-1):t.setMonth(Number(0)),n&&t.getMonth()!==Number(e)-1&&t.setMonth(Number(e)-1)},"%n":(t,e)=>{const n=/(^([0-9]?[0-9])$)/i.test(e);n?t.setMonth(Number(e)-1):t.setMonth(Number(0)),n&&t.getMonth()!==Number(e)-1&&t.setMonth(Number(e)-1)},"%M":(t,e)=>{const n=Oe(Jn.monthShort,(t=>t===e));-1===n?t.setMonth(0):t.setMonth(n),-1!==n&&t.getMonth()!==n&&t.setMonth(n)},"%F":(t,e)=>{const n=Oe(Jn.monthFull,(t=>t===e));-1===n?t.setMonth(0):t.setMonth(n),-1!==n&&t.getMonth()!==n&&t.setMonth(n)},"%y":(t,e)=>{/(^([0-9][0-9])$)/i.test(e)?t.setFullYear(Number("20"+e)):t.setFullYear(Number("2000"))},"%Y":(t,e)=>{/(^([0-9][0-9][0-9][0-9])$)/i.test(e)?t.setFullYear(Number(e)):t.setFullYear(Number("2000"))}};var Qn;function Kn(t){const e=[];let n="";for(let o=0;o<t.length;o++)"%"===t[o]?(n.length>0&&(e.push({type:Qn.separator,value:n}),n=""),e.push({type:Qn.datePart,value:t[o]+t[o+1]}),o++):n+=t[o];return n.length>0&&e.push({type:Qn.separator,value:n}),e}function Xn(t,e,n){return Jn=n||ye.calendar,Kn(e).reduce(((e,n)=>n.type===Qn.separator?e+n.value:Un[n.value]?e+Un[n.value](t):e),"")}function Zn(t,e){let n;const o=t=>{n=t.target},s=t=>{const o=An(n,"data-list-id");n===t.target&&(!function({id:t,api:e}){const{selected:n}=e.getState();if(Ee(t,n))return;Ae(n)&&!Ee(t,n)&&e.exec("unselect-task",{id:n});e.exec("select-task",{id:t})}({id:o,api:e.api}),t.stopPropagation())};return t.addEventListener("mousedown",o),t.addEventListener("mouseup",s),{destroy(){t.removeEventListener("mousedown",o),t.removeEventListener("mouseup",s)}}}function to(t,e){if(e.readonly)return;let n;const o=t=>{n=t.target},s=t=>{const o=An(n,"data-list-id"),s=An(n,"data-menu-id"),i=2===t.button;n===t.target&&(!function({api:t,id:e,menuId:n,context:o,coords:s}){const{menu:i}=t.getState(),r={...i};i.open&&"task"===i.type&&t.exec("close-menu",{...i}),(o||Ae(n)&&!i.open||Ae(n)&&r.context||!Ee(n,i.id)&&Ae(n))&&t.exec("open-menu",{id:e,type:"task",context:o,coords:s})}({api:e.api,id:o,menuId:s,coords:On(t),context:i}),t.stopPropagation())};return t.addEventListener("mousedown",o),t.addEventListener("mouseup",s),{destroy(){t.removeEventListener("mousedown",o),t.removeEventListener("mouseup",s)}}}function eo(t,e){const n=t=>{const n=En(t,"data-user-menu-id"),{menu:o}=e.api.getState();if(n){const s=An(t,"data-user-menu-id");if(!o.open||o.open&&!Ee(o.id,s)){const t=n.getBoundingClientRect();o.open&&e.api.exec("close-menu",{...o}),e.api.exec("open-menu",{id:s,type:"user",coords:{x:t.left,y:t.bottom}})}t.stopPropagation()}else o.open&&"user"===o.type&&e.api.exec("close-menu",{...o})};return t.addEventListener("pointerover",n),{destroy(){t.removeEventListener("pointerover",n)}}}function no(t,e){const n=t=>{const n=An(t.target,"data-tag");n&&(e.api.exec("set-filter",{match:n,highlight:!0,strict:!0}),e.api.exec("set-state-search",{value:n,open:!0,focus:!1,dropdown:{open:!1}}),t.stopPropagation())};return t.addEventListener("click",n),{destroy(){t.removeEventListener("click",n)}}}function oo(t,e){const n=t=>{const n=An(t.target,"data-due-date-id"),o=e.api.getTask({id:n});o&&(e.api.exec("set-state-due-date",{id:n,value:o.due_date,open:!0}),t.stopPropagation())};return t.addEventListener("click",n),{destroy(){t.removeEventListener("click",n)}}}function so(t,e){if(e.readonly)return;const n=e.api,o=t=>{const e=An(t.target,"data-list-editor-id"),o=An(t.target,"data-date"),{editableItem:s}=n.getState();o&&!Ae(s)&&n.exec("open-inline-editor",{id:e,type:"task",targetDate:o}),"task"!==s?.type||Ee(s?.id,e)||s?.dropdown||n.exec("close-inline-editor",{id:s.id,save:!0})},s=t=>{const e=An(t.target,"data-list-editor-id"),{editableItem:o}=n.getState();Ee(o?.id,e)||n.exec("open-inline-editor",{id:e,type:"task"})};return t.addEventListener("click",o),t.addEventListener("dblclick",s),{destroy(){t.removeEventListener("click",o),t.removeEventListener("dblclick",s)}}}function io(t,e){let n;const o=t=>{n=An(t,"data-todo-id")},s=t=>{Ee(e.widgetId,n)&&e.api.exec("keypress-on-todo",{code:ro(t),event:t})};return t.addEventListener("mousedown",o),t.addEventListener("focusin",o),t.addEventListener("keydown",s),{destroy(){t.removeEventListener("mousedown",o),t.removeEventListener("focusin",o),t.removeEventListener("keydown",s)}}}function ro(t){const e=[];let n=t?.code.toLowerCase();const o=t?.key.toLowerCase(),s=n.startsWith("key"),i=n.startsWith("digit");return(t.ctrlKey||t.metaKey)&&e.push("ctrl"),t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),s&&(n=n.replace("key","")),i&&(n=n.replace("digit","")),["control","alt","shift"].includes(o)||e.push(n),e.join("+")}function ao(t){let e,n,o,s;return{c(){e=C("i"),A(e,"class",n="wx-todo_icon wxi wxi-"+t[0]+" "+(t[4]?t[4]:"wx-todo_icon--default")+" svelte-1dloatb"),R(e,"font-size",t[1]+"px"),R(e,"height",t[1]+"px"),R(e,"width",t[1]+"px"),L(e,"wx-todo_icon--clickable",t[2]),L(e,"wx-todo_icon--disabled",t[3])},m(n,i){S(n,e,i),o||(s=N(e,"click",t[5]),o=!0)},p(t,[o]){17&o&&n!==(n="wx-todo_icon wxi wxi-"+t[0]+" "+(t[4]?t[4]:"wx-todo_icon--default")+" svelte-1dloatb")&&A(e,"class",n),2&o&&R(e,"font-size",t[1]+"px"),2&o&&R(e,"height",t[1]+"px"),2&o&&R(e,"width",t[1]+"px"),21&o&&L(e,"wx-todo_icon--clickable",t[2]),25&o&&L(e,"wx-todo_icon--disabled",t[3])},i:a,o:a,d(t){t&&T(e),o=!1,s()}}}function co(t,e,n){let{name:o}=e,{size:s=20}=e,{clickable:i=!1}=e,{disabled:r=!1}=e,{css:a=""}=e;return t.$$set=t=>{"name"in t&&n(0,o=t.name),"size"in t&&n(1,s=t.size),"clickable"in t&&n(2,i=t.clickable),"disabled"in t&&n(3,r=t.disabled),"css"in t&&n(4,a=t.css)},[o,s,i,r,a,function(e){U.call(this,t,e)}]}!function(t){t[t.separator=0]="separator",t[t.datePart=1]="datePart"}(Qn||(Qn={}));class lo extends yt{constructor(t){super(),bt(this,t,co,ao,f,{name:0,size:1,clickable:2,disabled:3,css:4})}}function uo(t){let e,n;return e=new lo({props:{name:"check",size:16}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function po(t){let e,n,o,s,i,r,a,c=t[0]&&uo();return{c(){e=C("label"),n=C("input"),o=P(),s=C("span"),c&&c.c(),A(n,"id",t[2]),n.disabled=t[1],A(n,"type","checkbox"),A(n,"class","wx-todo_checkbox__input svelte-1u2bz8m"),A(s,"class","wx-todo_checkbox__icon svelte-1u2bz8m"),L(s,"wx-todo_checkbox--checked",t[0]),A(e,"for",t[2]),A(e,"class","wx-todo_checkbox wx-todo_checkbox__label svelte-1u2bz8m"),L(e,"wx-todo_checkbox--disabled",t[1])},m(l,d){S(l,e,d),j(e,n),n.checked=t[0],j(e,o),j(e,s),c&&c.m(s,null),i=!0,r||(a=[N(n,"change",E(t[3])),N(n,"change",t[4])],r=!0)},p(t,[o]){(!i||4&o)&&A(n,"id",t[2]),(!i||2&o)&&(n.disabled=t[1]),1&o&&(n.checked=t[0]),t[0]?c?1&o&&ut(c,1):(c=uo(),c.c(),ut(c,1),c.m(s,null)):c&&(lt(),pt(c,1,1,(()=>{c=null})),dt()),1&o&&L(s,"wx-todo_checkbox--checked",t[0]),(!i||4&o)&&A(e,"for",t[2]),2&o&&L(e,"wx-todo_checkbox--disabled",t[1])},i(t){i||(ut(c),i=!0)},o(t){pt(c),i=!1},d(t){t&&T(e),c&&c.d(),r=!1,u(a)}}}function fo(t,e,n){let{disabled:o=!1}=e,{checked:s=!1}=e,{id:i=Ne().toString()}=e;return t.$$set=t=>{"disabled"in t&&n(1,o=t.disabled),"checked"in t&&n(0,s=t.checked),"id"in t&&n(2,i=t.id)},[s,o,i,function(e){U.call(this,t,e)},function(){s=this.checked,n(0,s)}]}class ho extends yt{constructor(t){super(),bt(this,t,fo,po,f,{disabled:1,checked:0,id:2})}}function go(t){let e,n,o,s;const i=t[4].default,r=$(i,t,t[3],null);return{c(){e=C("button"),r&&r.c(),A(e,"class","wx-todo_button svelte-10n97i3"),R(e,"width","number"==typeof t[0]?`${t[0]}px`:t[0]),R(e,"height","number"==typeof t[1]?`${t[1]}px`:t[1]),L(e,"wx-todo_button--circle",t[2])},m(i,a){S(i,e,a),r&&r.m(e,null),n=!0,o||(s=N(e,"click",t[5]),o=!0)},p(t,[o]){r&&r.p&&(!n||8&o)&&k(r,i,t,t[3],n?v(i,t[3],o,null):x(t[3]),null),(!n||1&o)&&R(e,"width","number"==typeof t[0]?`${t[0]}px`:t[0]),(!n||2&o)&&R(e,"height","number"==typeof t[1]?`${t[1]}px`:t[1]),4&o&&L(e,"wx-todo_button--circle",t[2])},i(t){n||(ut(r,t),n=!0)},o(t){pt(r,t),n=!1},d(t){t&&T(e),r&&r.d(t),o=!1,s()}}}function $o(t,e,n){let{$$slots:o={},$$scope:s}=e,{width:i=20}=e,{height:r=20}=e,{circle:a=!1}=e;return t.$$set=t=>{"width"in t&&n(0,i=t.width),"height"in t&&n(1,r=t.height),"circle"in t&&n(2,a=t.circle),"$$scope"in t&&n(3,s=t.$$scope)},[i,r,a,s,o,function(e){U.call(this,t,e)}]}class mo extends yt{constructor(t){super(),bt(this,t,$o,go,f,{width:0,height:1,circle:2})}}function vo(t){let e,n;return{c(){e=C("div"),n=I(t[0]),A(e,"class","wx-todo_avatar svelte-2w6inz"),R(e,"background-color",t[2]),R(e,"background-image","url("+t[1]+")")},m(t,o){S(t,e,o),j(e,n)},p(t,[o]){1&o&&F(n,t[0]),4&o&&R(e,"background-color",t[2]),2&o&&R(e,"background-image","url("+t[1]+")")},i:a,o:a,d(t){t&&T(e)}}}function ko(t,e,n){let{value:o=""}=e,{avatar:s=""}=e,{color:i="#0AB169"}=e;return t.$$set=t=>{"value"in t&&n(0,o=t.value),"avatar"in t&&n(1,s=t.avatar),"color"in t&&n(2,i=t.color)},[o,s,i]}class xo extends yt{constructor(t){super(),bt(this,t,ko,vo,f,{value:0,avatar:1,color:2})}}function wo(t){let e,n,o,s,i,r=t[3]&&yo(t),a=t[4]?.avatar&&_o(t),c=t[1]&&jo(t),l=t[2]&&So(t);return{c(){r&&r.c(),e=P(),a&&a.c(),n=P(),c&&c.c(),o=P(),l&&l.c(),s=M()},m(t,d){r&&r.m(t,d),S(t,e,d),a&&a.m(t,d),S(t,n,d),c&&c.m(t,d),S(t,o,d),l&&l.m(t,d),S(t,s,d),i=!0},p(t,i){t[3]?r?(r.p(t,i),8&i&&ut(r,1)):(r=yo(t),r.c(),ut(r,1),r.m(e.parentNode,e)):r&&(lt(),pt(r,1,1,(()=>{r=null})),dt()),t[4]?.avatar?a?(a.p(t,i),16&i&&ut(a,1)):(a=_o(t),a.c(),ut(a,1),a.m(n.parentNode,n)):a&&(lt(),pt(a,1,1,(()=>{a=null})),dt()),t[1]?c?c.p(t,i):(c=jo(t),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null),t[2]?l?l.p(t,i):(l=So(t),l.c(),l.m(s.parentNode,s)):l&&(l.d(1),l=null)},i(t){i||(ut(r),ut(a),i=!0)},o(t){pt(r),pt(a),i=!1},d(t){r&&r.d(t),t&&T(e),a&&a.d(t),t&&T(n),c&&c.d(t),t&&T(o),l&&l.d(t),t&&T(s)}}}function bo(t){let e;const n=t[12].default,o=$(n,t,t[11],null);return{c(){o&&o.c()},m(t,n){o&&o.m(t,n),e=!0},p(t,s){o&&o.p&&(!e||2048&s)&&k(o,n,t,t[11],e?v(n,t[11],s,null):x(t[11]),null)},i(t){e||(ut(o,t),e=!0)},o(t){pt(o,t),e=!1},d(t){o&&o.d(t)}}}function yo(t){let e,n;return e=new lo({props:{name:t[3],clickable:t[5],disabled:t[7]}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.name=t[3]),32&n&&(o.clickable=t[5]),128&n&&(o.disabled=t[7]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function _o(t){let e,n,o;return n=new xo({props:{avatar:t[4]?.avatar,color:t[4].color}}),{c(){e=C("div"),vt(n.$$.fragment),R(e,"margin-left",(t[3]?8:0)+"px")},m(t,s){S(t,e,s),kt(n,e,null),o=!0},p(t,s){const i={};16&s&&(i.avatar=t[4]?.avatar),16&s&&(i.color=t[4].color),n.$set(i),(!o||8&s)&&R(e,"margin-left",(t[3]?8:0)+"px")},i(t){o||(ut(n.$$.fragment,t),o=!0)},o(t){pt(n.$$.fragment,t),o=!1},d(t){t&&T(e),xt(n)}}}function jo(t){let e,n;return{c(){e=C("div"),n=I(t[1]),A(e,"class","wx-todo_item__label svelte-1dz5km3")},m(t,o){S(t,e,o),j(e,n)},p(t,e){2&e&&F(n,t[1])},d(t){t&&T(e)}}}function So(t){let e,n;return{c(){e=C("div"),n=I(t[2]),A(e,"class","wx-todo_item__hotkey svelte-1dz5km3")},m(t,o){S(t,e,o),j(e,n)},p(t,e){4&e&&F(n,t[2])},d(t){t&&T(e)}}}function To(t){let e,n,o,s,i;const r=[bo,wo],a=[];function c(t,e){return t[6]?0:1}return n=c(t),o=a[n]=r[n](t),{c(){e=C("div"),o.c(),A(e,"class","wx-todo_item svelte-1dz5km3"),A(e,"data-item-id",s=t[7]?null:t[0]),R(e,"min-width",t[10]),L(e,"wx-todo_item--clickable",t[5]),L(e,"wx-todo_item--disabled",t[7]),L(e,"wx-todo_item--checked",t[8]),L(e,"wx-todo_item--hover",t[9]),L(e,"wx-todo_item__avatar",t[4]?.color||t[4]?.avatar)},m(t,o){S(t,e,o),a[n].m(e,null),i=!0},p(t,[l]){let d=n;n=c(t),n===d?a[n].p(t,l):(lt(),pt(a[d],1,1,(()=>{a[d]=null})),dt(),o=a[n],o?o.p(t,l):(o=a[n]=r[n](t),o.c()),ut(o,1),o.m(e,null)),(!i||129&l&&s!==(s=t[7]?null:t[0]))&&A(e,"data-item-id",s),(!i||1024&l)&&R(e,"min-width",t[10]),32&l&&L(e,"wx-todo_item--clickable",t[5]),128&l&&L(e,"wx-todo_item--disabled",t[7]),256&l&&L(e,"wx-todo_item--checked",t[8]),512&l&&L(e,"wx-todo_item--hover",t[9]),16&l&&L(e,"wx-todo_item__avatar",t[4]?.color||t[4]?.avatar)},i(t){i||(ut(o),i=!0)},o(t){pt(o),i=!1},d(t){t&&T(e),a[n].d()}}}function Do(t,e,n){let{$$slots:o={},$$scope:s}=e,{id:i=null}=e,{label:r=null}=e,{hotkey:a=null}=e,{icon:c=null}=e,{avatar:l=null}=e,{clickable:d=!1}=e,{custom:u=!1}=e,{disabled:p=!1}=e,{checked:f=!1}=e,{hover:h=!0}=e,{minWidth:g="200px"}=e;return t.$$set=t=>{"id"in t&&n(0,i=t.id),"label"in t&&n(1,r=t.label),"hotkey"in t&&n(2,a=t.hotkey),"icon"in t&&n(3,c=t.icon),"avatar"in t&&n(4,l=t.avatar),"clickable"in t&&n(5,d=t.clickable),"custom"in t&&n(6,u=t.custom),"disabled"in t&&n(7,p=t.disabled),"checked"in t&&n(8,f=t.checked),"hover"in t&&n(9,h=t.hover),"minWidth"in t&&n(10,g=t.minWidth),"$$scope"in t&&n(11,s=t.$$scope)},[i,r,a,c,l,d,u,p,f,h,g,s,o]}class Co extends yt{constructor(t){super(),bt(this,t,Do,To,f,{id:0,label:1,hotkey:2,icon:3,avatar:4,clickable:5,custom:6,disabled:7,checked:8,hover:9,minWidth:10})}}const{window:Io}=ft;function Po(t){let e,n;const o=t[5].default,s=$(o,t,t[7],null);return{c(){e=C("div"),s&&s.c(),A(e,"data-popup-id",t[2]),R(e,"left",t[0].x+"px"),R(e,"top",t[0].y+"px"),A(e,"class","wx-material-theme wx-todo_popup svelte-1thl4la")},m(o,i){S(o,e,i),s&&s.m(e,null),t[6](e),n=!0},p(t,i){s&&s.p&&(!n||128&i)&&k(s,o,t,t[7],n?v(o,t[7],i,null):x(t[7]),null),(!n||4&i)&&A(e,"data-popup-id",t[2]),(!n||1&i)&&R(e,"left",t[0].x+"px"),(!n||1&i)&&R(e,"top",t[0].y+"px")},i(t){n||(ut(s,t),n=!0)},o(t){pt(s,t),n=!1},d(n){n&&T(e),s&&s.d(n),t[6](null)}}}function Mo(t){let e,n,o,s;return e=new ce({props:{theme:"material",$$slots:{default:[Po]},$$scope:{ctx:t}}}),{c(){vt(e.$$.fragment)},m(i,r){kt(e,i,r),n=!0,o||(s=N(Io,"click",t[3]),o=!0)},p(t,[n]){const o={};135&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t),o=!1,s()}}}function No(t,e,n){let{$$slots:o={},$$scope:s}=e,{id:i=null}=e,{coords:r}=e,{offset:a=0}=e,{node:c=null}=e;const l=G();return t.$$set=t=>{"id"in t&&n(2,i=t.id),"coords"in t&&n(0,r=t.coords),"offset"in t&&n(4,a=t.offset),"node"in t&&n(1,c=t.node),"$$scope"in t&&n(7,s=t.$$scope)},t.$$.update=()=>{19&t.$$.dirty&&c&&n(0,r=function(t,e,n){const o=document.body.getBoundingClientRect(),{offsetWidth:s,offsetHeight:i}=t,r=window.pageXOffset,a=window.pageYOffset;let c=e.y+n+a,l=e.x+n+r;return c+i>o.bottom&&(c=e.y-n-i),l+s>o.right&&(l=e.x-n-s),{x:l,y:c}}(c,r,a))},[r,c,i,function(t){Ae(c)&&!c.contains(t.target)&&l("cancel",{event:t})},a,o,function(t){Q[t?"unshift":"push"]((()=>{c=t,n(1,c)}))},s]}class Eo extends yt{constructor(t){super(),bt(this,t,No,Mo,f,{id:2,coords:0,offset:4,node:1})}}function Ao(t,e,n){const o=t.slice();return o[14]=e[n],o}const Fo=t=>({item:2&t}),Oo=t=>({item:t[14]});function Ro(t,e){let n,o,s,i;const r=e[10].default,a=$(r,e,e[12],Oo);return{key:t,first:null,c(){n=C("li"),a&&a.c(),o=P(),A(n,"class","wx-todo_menu__item svelte-1a9nye2"),A(n,"data-item-id",s=e[14]?.disabled?null:e[14]?.id),L(n,"wx-todo_menu__item--selected",Ee(e[14].id,e[7])&&e[6]),this.first=n},m(t,e){S(t,n,e),a&&a.m(n,null),j(n,o),i=!0},p(t,o){e=t,a&&a.p&&(!i||4098&o)&&k(a,r,e,e[12],i?v(r,e[12],o,Fo):x(e[12]),Oo),(!i||2&o&&s!==(s=e[14]?.disabled?null:e[14]?.id))&&A(n,"data-item-id",s),194&o&&L(n,"wx-todo_menu__item--selected",Ee(e[14].id,e[7])&&e[6])},i(t){i||(ut(a,t),i=!0)},o(t){pt(a,t),i=!1},d(t){t&&T(n),a&&a.d(t)}}}function Lo(t){let e,n,o,s,i=[],r=new Map,a=t[1];const c=t=>t[14].id;for(let e=0;e<a.length;e+=1){let n=Ao(t,a,e),o=c(n);r.set(o,i[e]=Ro(o,n))}return{c(){e=C("ul");for(let t=0;t<i.length;t+=1)i[t].c();A(e,"class","wx-todo_menu svelte-1a9nye2"),R(e,"width","number"==typeof t[4]?`${t[4]}px`:t[4]),R(e,"height","number"==typeof t[5]?`${t[5]}px`:t[5])},m(r,a){S(r,e,a);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0,o||(s=N(e,"click",E(t[8])),o=!0)},p(t,o){4290&o&&(a=t[1],lt(),i=$t(i,o,c,1,t,a,r,e,gt,Ro,null,Ao),dt()),(!n||16&o)&&R(e,"width","number"==typeof t[4]?`${t[4]}px`:t[4]),(!n||32&o)&&R(e,"height","number"==typeof t[5]?`${t[5]}px`:t[5])},i(t){if(!n){for(let t=0;t<a.length;t+=1)ut(i[t]);n=!0}},o(t){for(let t=0;t<i.length;t+=1)pt(i[t]);n=!1},d(t){t&&T(e);for(let t=0;t<i.length;t+=1)i[t].d();o=!1,s()}}}function Yo(t){let e,n,o,s;return e=new Eo({props:{coords:t[2],offset:t[3],id:t[0],$$slots:{default:[Lo]},$$scope:{ctx:t}}}),e.$on("cancel",t[11]),{c(){vt(e.$$.fragment)},m(i,r){kt(e,i,r),n=!0,o||(s=N(window,"keydown",t[9]),o=!0)},p(t,[n]){const o={};4&n&&(o.coords=t[2]),8&n&&(o.offset=t[3]),1&n&&(o.id=t[0]),4338&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t),o=!1,s()}}}function zo(t,e,n){let{$$slots:o={},$$scope:s}=e,{id:i=null}=e,{data:r=[]}=e,{coords:a}=e,{offset:c=0}=e,{width:l="auto"}=e,{height:d="auto"}=e,{clickable:u=!0}=e,p=null;const f=G();return t.$$set=t=>{"id"in t&&n(0,i=t.id),"data"in t&&n(1,r=t.data),"coords"in t&&n(2,a=t.coords),"offset"in t&&n(3,c=t.offset),"width"in t&&n(4,l=t.width),"height"in t&&n(5,d=t.height),"clickable"in t&&n(6,u=t.clickable),"$$scope"in t&&n(12,s=t.$$scope)},[i,r,a,c,l,d,u,p,function(t){u&&(n(7,p=An(t,"data-item-id")),f("click",{id:p}))},function(t){var e,o;const s=r.findIndex((t=>Ee(t.id,p)));switch(t.code){case"ArrowUp":t.preventDefault(),n(7,p=Ae(p)?null===(e=r[s-1])||void 0===e?void 0:e.id:r[r.length-1].id);break;case"ArrowDown":t.preventDefault(),n(7,p=Ae(p)?null===(o=r[s+1])||void 0===o?void 0:o.id:r[0].id);break;case"Enter":t.preventDefault(),f("click",{id:p})}},o,function(e){U.call(this,t,e)},s]}class Bo extends yt{constructor(t){super(),bt(this,t,zo,Yo,f,{id:0,data:1,coords:2,offset:3,width:4,height:5,clickable:6})}}function Ho(t){let e,n;return e=new Co({props:{label:t[3].label,avatar:{avatar:t[3].avatar,color:t[3].color},hover:!1}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.label=t[3].label),8&n&&(o.avatar={avatar:t[3].avatar,color:t[3].color}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Wo(t){let e,n;return e=new Bo({props:{coords:t[0],data:t[1],clickable:!1,$$slots:{default:[Ho,({item:t})=>({3:t}),({item:t})=>t?8:0]},$$scope:{ctx:t}}}),e.$on("cancel",t[2]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,[n]){const o={};1&n&&(o.coords=t[0]),2&n&&(o.data=t[1]),24&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Go(t,e,n){let{coords:o}=e,{data:s}=e;return t.$$set=t=>{"coords"in t&&n(0,o=t.coords),"data"in t&&n(1,s=t.data)},[o,s,function(e){U.call(this,t,e)}]}class Vo extends yt{constructor(t){super(),bt(this,t,Go,Wo,f,{coords:0,data:1})}}function Jo(t){let e,n;return{c(){e=C("div"),n=C("div"),A(n,"class","wx-todo_separator__line svelte-1p06fwl"),A(e,"class","wx-todo_separator svelte-1p06fwl"),R(e,"padding",t[0])},m(t,o){S(t,e,o),j(e,n)},p(t,[n]){1&n&&R(e,"padding",t[0])},i:a,o:a,d(t){t&&T(e)}}}function Uo(t,e,n){let{padding:o="6px 16px"}=e;return t.$$set=t=>{"padding"in t&&n(0,o=t.padding)},[o]}class qo extends yt{constructor(t){super(),bt(this,t,Uo,Jo,f,{padding:0})}}function Qo(t,e,n){const o=t.slice();return o[14]=e[n],o}function Ko(t,e,n){const o=t.slice();return o[17]=e[n],o}function Xo(t){let e,n,o,s,i,r,a,c,l,d,u,p=t[17].label+"";o=new lo({props:{name:t[17].icon}});const f=[es,ts],h=[];return~(c=function(t,e){return t[17]?.items?.length?0:t[17].hotkey?1:-1}(t))&&(l=h[c]=f[c](t)),{c(){e=C("li"),n=C("div"),vt(o.$$.fragment),s=P(),i=C("span"),r=I(p),a=P(),l&&l.c(),d=P(),A(i,"class","wx-todo_menu-item__description svelte-178o6vj"),A(n,"class","wx-todo_menu-item__wrapper svelte-178o6vj"),A(e,"class","wx-todo_menu-item svelte-178o6vj"),A(e,"data-menu-item-id",t[17].id)},m(t,l){S(t,e,l),j(e,n),kt(o,n,null),j(n,s),j(n,i),j(i,r),j(e,a),~c&&h[c].m(e,null),j(e,d),u=!0},p(t,e){l&&l.p(t,e)},i(t){u||(ut(o.$$.fragment,t),ut(l),u=!0)},o(t){pt(o.$$.fragment,t),pt(l),u=!1},d(t){t&&T(e),xt(o),~c&&h[c].d()}}}function Zo(t){let e,n;return e=new qo({props:{padding:"0"}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p:a,i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function ts(t){let e,n,o=t[17].hotkey+"";return{c(){e=C("span"),n=I(o),A(e,"class","wx-todo_menu-item__hotkey svelte-178o6vj")},m(t,o){S(t,e,o),j(e,n)},p:a,i:a,o:a,d(t){t&&T(e)}}}function es(t){let e,n;return e=new lo({props:{name:"menu-right"}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p:a,i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function ns(t){let e,n,o,s;const i=[Zo,Xo],r=[];return e=function(t,e){return"separator"===t[17].type?0:1}(t),n=r[e]=i[e](t),{c(){n.c(),o=M()},m(t,n){r[e].m(t,n),S(t,o,n),s=!0},p(t,e){n.p(t,e)},i(t){s||(ut(n),s=!0)},o(t){pt(n),s=!1},d(t){r[e].d(t),t&&T(o)}}}function os(t){let e,n,o,s,i=t[4],r=[];for(let e=0;e<i.length;e+=1)r[e]=ns(Ko(t,i,e));const a=t=>pt(r[t],1,1,(()=>{r[t]=null}));return{c(){e=C("ul");for(let t=0;t<r.length;t+=1)r[t].c();A(e,"data-menu-id",t[1]),A(e,"class","wx-todo_menu svelte-178o6vj")},m(i,a){S(i,e,a);for(let t=0;t<r.length;t+=1)r[t].m(e,null);n=!0,o||(s=N(e,"click",E(t[6])),o=!0)},p(t,o){if(16&o){let n;for(i=t[4],n=0;n<i.length;n+=1){const s=Ko(t,i,n);r[n]?(r[n].p(s,o),ut(r[n],1)):(r[n]=ns(s),r[n].c(),ut(r[n],1),r[n].m(e,null))}for(lt(),n=i.length;n<r.length;n+=1)a(n);dt()}(!n||2&o)&&A(e,"data-menu-id",t[1])},i(t){if(!n){for(let t=0;t<i.length;t+=1)ut(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)pt(r[t]);n=!1},d(t){t&&T(e),D(r,t),o=!1,s()}}}function ss(t){let e,n;return e=new Eo({props:{coords:t[2].coords,$$slots:{default:[rs]},$$scope:{ctx:t}}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.coords=t[2].coords),1048590&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function is(t){let e,n,o,s,i,r;return n=new Co({props:{label:t[14].label,avatar:{avatar:t[14].avatar,color:t[14].color},icon:t[14].checked?"check":" ",checked:t[14].checked,clickable:!0}}),{c(){e=C("li"),vt(n.$$.fragment),o=P(),A(e,"data-menu-parent-id",s=t[3].id),A(e,"data-menu-item-id",i=t[14].id)},m(t,s){S(t,e,s),kt(n,e,null),j(e,o),r=!0},p(t,o){const a={};8&o&&(a.label=t[14].label),8&o&&(a.avatar={avatar:t[14].avatar,color:t[14].color}),8&o&&(a.icon=t[14].checked?"check":" "),8&o&&(a.checked=t[14].checked),n.$set(a),(!r||8&o&&s!==(s=t[3].id))&&A(e,"data-menu-parent-id",s),(!r||8&o&&i!==(i=t[14].id))&&A(e,"data-menu-item-id",i)},i(t){r||(ut(n.$$.fragment,t),r=!0)},o(t){pt(n.$$.fragment,t),r=!1},d(t){t&&T(e),xt(n)}}}function rs(t){let e,n,o,s,i=t[3]?.items||[],r=[];for(let e=0;e<i.length;e+=1)r[e]=is(Qo(t,i,e));const a=t=>pt(r[t],1,1,(()=>{r[t]=null}));return{c(){e=C("ul");for(let t=0;t<r.length;t+=1)r[t].c();A(e,"data-menu-id",t[1]),A(e,"class","wx-todo_menu svelte-178o6vj")},m(i,a){S(i,e,a);for(let t=0;t<r.length;t+=1)r[t].m(e,null);t[10](e),n=!0,o||(s=N(e,"click",E(t[6])),o=!0)},p(t,o){if(8&o){let n;for(i=t[3]?.items||[],n=0;n<i.length;n+=1){const s=Qo(t,i,n);r[n]?(r[n].p(s,o),ut(r[n],1)):(r[n]=is(s),r[n].c(),ut(r[n],1),r[n].m(e,null))}for(lt(),n=i.length;n<r.length;n+=1)a(n);dt()}(!n||2&o)&&A(e,"data-menu-id",t[1])},i(t){if(!n){for(let t=0;t<i.length;t+=1)ut(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)pt(r[t]);n=!1},d(n){n&&T(e),D(r,n),t[10](null),o=!1,s()}}}function as(t){let e,n,o,s,i,r,a=Ae(t[3]?.id)&&Ee(t[2]?.id,t[3]?.id);e=new Eo({props:{coords:t[0],offset:10,$$slots:{default:[os]},$$scope:{ctx:t}}});let c=a&&ss(t);return{c(){vt(e.$$.fragment),n=P(),c&&c.c(),o=M()},m(a,l){kt(e,a,l),S(a,n,l),c&&c.m(a,l),S(a,o,l),s=!0,i||(r=N(window,"pointerover",E(t[5])),i=!0)},p(t,[n]){const s={};1&n&&(s.coords=t[0]),1048578&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s),12&n&&(a=Ae(t[3]?.id)&&Ee(t[2]?.id,t[3]?.id)),a?c?(c.p(t,n),12&n&&ut(c,1)):(c=ss(t),c.c(),ut(c,1),c.m(o.parentNode,o)):c&&(lt(),pt(c,1,1,(()=>{c=null})),dt())},i(t){s||(ut(e.$$.fragment,t),ut(c),s=!0)},o(t){pt(e.$$.fragment,t),pt(c),s=!1},d(t){xt(e,t),t&&T(n),c&&c.d(t),t&&T(o),i=!1,r()}}}function cs(t,e,n){let o,s,i,{data:r=[]}=e,{coords:a=null}=e,{id:c=Ne()}=e;const l=J("wx-i18n").getGroup("todo"),d=Le(r,l);let u=null;const p=G();return t.$$set=t=>{"data"in t&&n(7,r=t.data),"coords"in t&&n(0,a=t.coords),"id"in t&&n(1,c=t.id)},t.$$.update=()=>{if(384&t.$$.dirty&&n(3,o=r.find((t=>Ee(t.id,u)))),516&t.$$.dirty&&Ae(null==i?void 0:i.id)&&Ae(null==i?void 0:i.node)){const t=s.getBoundingClientRect(),e=i.node.getBoundingClientRect(),o=document.body.getBoundingClientRect(),{offsetWidth:r,offsetHeight:a}=s;let c=t.y,l=t.x+t.width;c+a>o.bottom&&(c-=a),l+r>o.right&&(l=l-r-e.width),n(2,i.coords.x=l,i),n(2,i.coords.y=c,i),c+e.height>o.bottom&&n(2,i.node.style.height=o.bottom-c+"px",i)}},n(9,s=null),n(2,i={id:null,coords:{x:null,y:null},node:null}),[a,c,i,o,d,function(t){var e;const r=An(t,"data-menu-item-id"),a=An(t,"data-menu-parent-id");n(8,u=Ae(a)?a:r),Ae(r)&&!Ae(a)&&(null===(e=null==o?void 0:o.items)||void 0===e?void 0:e.length)&&(n(9,s=En(t,"data-menu-item-id")),n(2,i.id=r,i))},function(t){const e=An(t,"data-menu-item-id"),o=An(t,"data-menu-parent-id");Ae(o)?p("click",{id:o,extra:e}):Ae(e)&&p("click",{id:e}),"moveProject"===o&&n(2,i={id:null,coords:{x:null,y:null},node:null})},r,u,s,function(t){Q[t?"unshift":"push"]((()=>{i.node=t,n(2,i),n(9,s)}))}]}class ls extends yt{constructor(t){super(),bt(this,t,cs,as,f,{data:7,coords:0,id:1})}}function ds(t){let e,n=Vn(t[0],t[1])+"";return{c(){e=C("div"),A(e,"class","wx-todo_text svelte-16k3e98"),A(e,"tabindex","0"),L(e,"wx-todo_text--completed",t[2])},m(t,o){S(t,e,o),e.innerHTML=n},p(t,[o]){3&o&&n!==(n=Vn(t[0],t[1])+"")&&(e.innerHTML=n),4&o&&L(e,"wx-todo_text--completed",t[2])},i:a,o:a,d(t){t&&T(e)}}}function us(t,e,n){let{value:o=""}=e,{filter:s}=e,{completed:i=!1}=e;return t.$$set=t=>{"value"in t&&n(0,o=t.value),"filter"in t&&n(1,s=t.filter),"completed"in t&&n(2,i=t.completed)},[o,s,i]}class ps extends yt{constructor(t){super(),bt(this,t,us,ds,f,{value:0,filter:1,completed:2})}}function fs(t){let e,n,o;function s(e){t[8](e)}let i={cancel:t[3]};return void 0!==t[2]&&(i.value=t[2]),e=new ie({props:i}),Q.push((()=>mt(e,"value",s))),{c(){vt(e.$$.fragment)},m(t,n){kt(e,t,n),o=!0},p(t,o){const s={};!n&&4&o&&(n=!0,s.value=t[2],nt((()=>n=!1))),e.$set(s)},i(t){o||(ut(e.$$.fragment,t),o=!0)},o(t){pt(e.$$.fragment,t),o=!1},d(t){xt(e,t)}}}function hs(t){let e,n;return e=new Eo({props:{id:t[0],coords:t[1],$$slots:{default:[fs]},$$scope:{ctx:t}}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,[n]){const o={};1&n&&(o.id=t[0]),2&n&&(o.coords=t[1]),4100&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function gs(t,e,n){let{id:o}=e,{coords:s}=e,{cancel:i=null}=e,{date:r=null}=e,{dateFormat:a="%d %M %Y"}=e,{convert:c=!0}=e;const l=G(),d=J("wx-i18n").getGroup("calendar");let u=null,p=r?function(t,e,n=!1,o){if("string"!=typeof t)return;Jn=o||ye.calendar;const s=Kn(e),i=[];let r,a=0,c=null;for(const e of s)if(e.type===Qn.separator){const o=t.indexOf(e.value,a);if(-1===o){if(n)return!1;throw new Error("Incorrect Date")}c&&(i.push({formatter:c,value:t.slice(a,o)}),c=null),a=o+e.value.length}else e.type===Qn.datePart&&(c=e.value);"%A"===c||"%a"===c?i.unshift({formatter:c,value:t.slice(a)}):c&&i.push({formatter:c,value:t.slice(a)}),i.reverse();for(const t of i)"%A"!==t.formatter&&"%a"!==t.formatter||(r=t.value);const l=new Date(0);for(const t of i)qn[t.formatter]&&qn[t.formatter](l,t.value,r);return l}(r,a,!0,Ye(d)):null;r instanceof Date&&(p=r),"string"==typeof r&&(p=new Date(r)),(null==p?void 0:p.getTime())||(p=null),u=p?new Date(p.getFullYear(),p.getMonth(),p.getDate()):null;return t.$$set=t=>{"id"in t&&n(0,o=t.id),"coords"in t&&n(1,s=t.coords),"cancel"in t&&n(4,i=t.cancel),"date"in t&&n(5,r=t.date),"dateFormat"in t&&n(6,a=t.dateFormat),"convert"in t&&n(7,c=t.convert)},[o,s,u,()=>{u?l("change",{value:c?Xn(u,a,Ye(d)):u}):i&&i()},i,r,a,c,function(t){u=t,n(2,u)}]}class $s extends yt{constructor(t){super(),bt(this,t,gs,hs,f,{id:0,coords:1,cancel:4,date:5,dateFormat:6,convert:7})}}function ms(t){let e,n,o,s="menu"===t[3].dropdown.type&&vs(t),i="datepicker"===t[3].dropdown.type&&xs(t);return{c(){s&&s.c(),e=P(),i&&i.c(),n=M()},m(t,r){s&&s.m(t,r),S(t,e,r),i&&i.m(t,r),S(t,n,r),o=!0},p(t,o){"menu"===t[3].dropdown.type?s?(s.p(t,o),8&o&&ut(s,1)):(s=vs(t),s.c(),ut(s,1),s.m(e.parentNode,e)):s&&(lt(),pt(s,1,1,(()=>{s=null})),dt()),"datepicker"===t[3].dropdown.type?i?(i.p(t,o),8&o&&ut(i,1)):(i=xs(t),i.c(),ut(i,1),i.m(n.parentNode,n)):i&&(lt(),pt(i,1,1,(()=>{i=null})),dt())},i(t){o||(ut(s),ut(i),o=!0)},o(t){pt(s),pt(i),o=!1},d(t){s&&s.d(t),t&&T(e),i&&i.d(t),t&&T(n)}}}function vs(t){let e,n;return e=new Bo({props:{id:t[3].id,coords:t[3].dropdown.coords,data:t[3].dropdown.data,$$slots:{default:[ks,({item:t})=>({19:t}),({item:t})=>t?524288:0]},$$scope:{ctx:t}}}),e.$on("click",t[9]),e.$on("cancel",t[5]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.id=t[3].id),8&n&&(o.coords=t[3].dropdown.coords),8&n&&(o.data=t[3].dropdown.data),1572864&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function ks(t){let e,n;return e=new Co({props:{label:t[19].label,clickable:!0,minWidth:"50px"}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};524288&n&&(o.label=t[19].label),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function xs(t){let e,n;return e=new $s({props:{id:t[3].id,dateFormat:t[2].date.format,coords:t[3].dropdown.coords,cancel:t[6],date:t[3].targetDate}}),e.$on("change",t[10]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.id=t[3].id),4&n&&(o.dateFormat=t[2].date.format),8&n&&(o.coords=t[3].dropdown.coords),8&n&&(o.date=t[3].targetDate),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function ws(t){let e,n,o,s,i,r,a,c=t[3].dropdown&&ms(t);return{c(){e=C("div"),n=I(t[0]),o=P(),c&&c.c(),s=M(),A(e,"class","wx-todo_editor svelte-124gm4f"),A(e,"contenteditable","true"),A(e,"data-placeholder",t[1]),A(e,"tabindex","0")},m(l,d){S(l,e,d),j(e,n),t[12](e),S(l,o,d),c&&c.m(l,d),S(l,s,d),i=!0,r||(a=[N(e,"input",t[7]),N(e,"keyup",t[8])],r=!0)},p(t,[o]){(!i||1&o)&&F(n,t[0]),(!i||2&o)&&A(e,"data-placeholder",t[1]),t[3].dropdown?c?(c.p(t,o),8&o&&ut(c,1)):(c=ms(t),c.c(),ut(c,1),c.m(s.parentNode,s)):c&&(lt(),pt(c,1,1,(()=>{c=null})),dt())},i(t){i||(ut(c),i=!0)},o(t){pt(c),i=!1},d(n){n&&T(e),t[12](null),n&&T(o),c&&c.d(n),n&&T(s),r=!1,u(a)}}}function bs(t,e,n){let{value:o=""}=e,{placeholder:s=""}=e,{tags:i=[]}=e,{shape:r}=e,{editor:a}=e,c=null,l=null,d=null;const u=G();function p(t){const{x:e,y:n}=function(){const t=window.getSelection().getRangeAt(0).getBoundingClientRect();return{x:t.x,y:t.y}}();u("editing",{value:l,dropdown:{type:t,coords:{x:e,y:n+20},data:"menu"===t?Wn(i,""):[]},targetDate:a.targetDate})}function f(){u("editing",{dropdown:null,value:l})}function h(t,e,o){const s=t[d+1],i=t;if(e=o+e,s)if(Re(s)){const n=new RegExp(String.raw`${o}\s`,"gm");t=t.replace(n,((t,n)=>n===d?`${e} `:t))}else if("!"===o){const n=new RegExp(/!\((.+?)\)/gm);t=t.replace(n,((t,n,o)=>o===d?e:t))}else t=t.replace(Ue(o),((t,n)=>n===d?e:t));else t+=e.substring(1);l=t,n(4,c.innerHTML=Gn(t),c),Fn(c,d+(i!==l?e.length:1)),f()}return W((function(){l=o,a.targetDate?(d=l.indexOf(a.targetDate)-2,Fn(c,d),p("datepicker")):Fn(c)})),t.$$set=t=>{"value"in t&&n(0,o=t.value),"placeholder"in t&&n(1,s=t.placeholder),"tags"in t&&n(11,i=t.tags),"shape"in t&&n(2,r=t.shape),"editor"in t&&n(3,a=t.editor)},[o,s,r,a,c,f,function(){h(l,"","!"),f()},function(){l=(null==c?void 0:c.textContent)||"",u("editing",{value:l,dropdown:a.dropdown})},function(t){if("Enter"===t.code)return;const e="#",n="!",o=function(t){const e=window.getSelection(),n=document.createRange();return n.setStart(t,0),n.setEnd(e.anchorNode,e.anchorOffset),n.toString().length}(c)-1,s=l[o],r=l[o-1],h=!Ae(r)||Re(r),g=(s===e||t.key===e)&&h,$=(s===n||t.key===n)&&h;if(g)p("menu"),d=o;else if($)p("datepicker"),d=o;else if(a.dropdown){const t=[],n=new RegExp(/^\s*$/gm);for(let s=o;s>0;s--){const o=l[s];if(o===e){const e=t.reverse().join(""),n=Wn(i,e);if(!n.length)break;return void u("editing",{dropdown:Object.assign(Object.assign({},a.dropdown),{data:n}),value:l})}if(t.push(o),n.test(o))break}f()}},function(t){const e=t.detail.id;Ae(e)?h(l,e.substring(1),"#"):f()},function(t){const e=t.detail.value;h(l,`(${e})`,"!")},i,function(t){Q[t?"unshift":"push"]((()=>{c=t,n(4,c)}))}]}class ys extends yt{constructor(t){super(),bt(this,t,bs,ws,f,{value:0,placeholder:1,tags:11,shape:2,editor:3})}}function _s(t){let e,n,o,s,i,r,a,c,l;function d(t,e){return(null==i||33&e)&&(i=!("string"!=typeof t[0]||Ae(t[5]))),i?Ts:t[5]instanceof Date?Ss:js}n=new lo({props:{name:"calendar",css:t[8],size:14}});let u=d(t,-1),p=u(t),f=t[6]&&t[4]&&Ds(t);return{c(){e=C("div"),vt(n.$$.fragment),o=P(),s=C("span"),p.c(),a=P(),f&&f.c(),c=M(),A(s,"class",r=y(t[8])+" svelte-1lekpj1"),A(e,"class","wx-todo_due-date svelte-1lekpj1"),A(e,"data-due-date-id",t[1]),L(e,"completed",t[3])},m(i,r){S(i,e,r),kt(n,e,null),j(e,o),j(e,s),p.m(s,null),t[15](e),S(i,a,r),f&&f.m(i,r),S(i,c,r),l=!0},p(t,o){const i={};256&o&&(i.css=t[8]),n.$set(i),u===(u=d(t,o))&&p?p.p(t,o):(p.d(1),p=u(t),p&&(p.c(),p.m(s,null))),(!l||256&o&&r!==(r=y(t[8])+" svelte-1lekpj1"))&&A(s,"class",r),(!l||2&o)&&A(e,"data-due-date-id",t[1]),8&o&&L(e,"completed",t[3]),t[6]&&t[4]?f?(f.p(t,o),80&o&&ut(f,1)):(f=Ds(t),f.c(),ut(f,1),f.m(c.parentNode,c)):f&&(lt(),pt(f,1,1,(()=>{f=null})),dt())},i(t){l||(ut(n.$$.fragment,t),ut(f),l=!0)},o(t){pt(n.$$.fragment,t),pt(f),l=!1},d(o){o&&T(e),xt(n),p.d(),t[15](null),o&&T(a),f&&f.d(o),o&&T(c)}}}function js(t){let e,n=t[9]("Set due date")+"";return{c(){e=I(n)},m(t,n){S(t,e,n)},p:a,d(t){t&&T(e)}}}function Ss(t){let e,n=Xn(t[5],t[2],Ye(t[10]))+"";return{c(){e=I(n)},m(t,n){S(t,e,n)},p(t,o){36&o&&n!==(n=Xn(t[5],t[2],Ye(t[10]))+"")&&F(e,n)},d(t){t&&T(e)}}}function Ts(t){let e;return{c(){e=I(t[0])},m(t,n){S(t,e,n)},p(t,n){1&n&&F(e,t[0])},d(t){t&&T(e)}}}function Ds(t){let e,n;return e=new $s({props:{id:t[1],coords:t[7],convert:!1,dateFormat:t[2],date:t[5],cancel:t[11]}}),e.$on("change",t[12]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.id=t[1]),128&n&&(o.coords=t[7]),4&n&&(o.dateFormat=t[2]),32&n&&(o.date=t[5]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Cs(t){let e,n,o=(t[0]||t[6])&&_s(t);return{c(){o&&o.c(),e=M()},m(t,s){o&&o.m(t,s),S(t,e,s),n=!0},p(t,[n]){t[0]||t[6]?o?(o.p(t,n),65&n&&ut(o,1)):(o=_s(t),o.c(),ut(o,1),o.m(e.parentNode,e)):o&&(lt(),pt(o,1,1,(()=>{o=null})),dt())},i(t){n||(ut(o),n=!0)},o(t){pt(o),n=!1},d(t){o&&o.d(t),t&&T(e)}}}function Is(t,e,n){let o,{id:s=null}=e,{format:i="%d %M %Y"}=e,{date:r=null}=e,{validate:a=!0}=e,{completed:c=!1}=e,{datePicker:l}=e;const d=J("wx-i18n").getGroup("todo"),u=J("wx-i18n").getGroup("calendar"),p=G();let f=null,h=null,g=null,$="wx-todo_date";return t.$$set=t=>{"id"in t&&n(1,s=t.id),"format"in t&&n(2,i=t.format),"date"in t&&n(0,r=t.date),"validate"in t&&n(13,a=t.validate),"completed"in t&&n(3,c=t.completed),"datePicker"in t&&n(14,l=t.datePicker)},t.$$.update=()=>{if(16386&t.$$.dirty&&n(6,o=Ee(null==l?void 0:l.id,s)&&(null==l?void 0:l.open)),8305&t.$$.dirty&&f){if(o){const t=document.body.getBoundingClientRect(),e=f.getBoundingClientRect();let o=e.left,s=e.bottom;e.right>=t.right&&(o=t.right-e.width),e.bottom>=t.bottom&&(s=t.bottom-e.height),n(7,h={x:o,y:s})}if(r instanceof Date&&n(5,g=r),"string"==typeof r&&n(5,g=new Date(r)),(null==g?void 0:g.getTime())||n(5,g=null),a&&g){const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o=new Date(g.getFullYear(),g.getMonth(),g.getDate());e.getTime()<=o.getTime()?n(8,$="wx-todo_date--current"):n(8,$="wx-todo_date--expired")}}},[r,s,i,c,f,g,o,h,$,d,u,function(t){p("action",{action:"set-state-due-date",data:{id:s,value:void 0===t?null:g,open:!1}}),n(8,$="wx-todo_date"),n(5,g=n(0,r=null))},function(t){const e=t.detail.value;p("action",{action:"set-state-due-date",data:{id:s,value:e,open:!1}})},a,l,function(t){Q[t?"unshift":"push"]((()=>{f=t,n(4,f)}))}]}class Ps extends yt{constructor(t){super(),bt(this,t,Is,Cs,f,{id:1,format:2,date:0,validate:13,completed:3,datePicker:14})}}function Ms(t,e,n){const o=t.slice();return o[25]=e[n],o[27]=n,o}function Ns(t){let e,n,o;return n=new mo({props:{circle:!0,$$slots:{default:[Es]},$$scope:{ctx:t}}}),n.$on("click",t[16]),{c(){e=C("div"),vt(n.$$.fragment),A(e,"class","wx-todo_list-toggle-button svelte-1wld78x")},m(t,s){S(t,e,s),kt(n,e,null),o=!0},p(t,e){const o={};268435457&e&&(o.$$scope={dirty:e,ctx:t}),n.$set(o)},i(t){o||(ut(n.$$.fragment,t),o=!0)},o(t){pt(n.$$.fragment,t),o=!1},d(t){t&&T(e),xt(n)}}}function Es(t){let e,n;return e=new lo({props:{name:t[0].collapsed?"menu-right":"menu-down"}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.name=t[0].collapsed?"menu-right":"menu-down"),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function As(t){let e,n;return e=new ps({props:{value:t[0].text||"",completed:t[0].checked,filter:t[4]}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.value=t[0].text||""),1&n&&(o.completed=t[0].checked),16&n&&(o.filter=t[4]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Fs(t){let e,n;return e=new ys({props:{value:t[0].text||"",placeholder:t[14]("Type what you want"),shape:t[6],editor:t[2],tags:t[5]}}),e.$on("editing",t[17]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.value=t[0].text||""),64&n&&(o.shape=t[6]),4&n&&(o.editor=t[2]),32&n&&(o.tags=t[5]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Os(t){let e;function n(t,e){return"number"===t[0].counter.type?Ls:"percentage"===t[0].counter.type?Rs:void 0}let o=n(t),s=o&&o(t);return{c(){e=C("div"),s&&s.c(),A(e,"class","wx-todo_list__counter svelte-1wld78x")},m(t,n){S(t,e,n),s&&s.m(e,null)},p(t,i){o===(o=n(t))&&s?s.p(t,i):(s&&s.d(1),s=o&&o(t),s&&(s.c(),s.m(e,null)))},d(t){t&&T(e),s&&s.d()}}}function Rs(t){let e,n,o=Math.round(t[0].counter.done/t[0].counter.total*100)+"";return{c(){e=I(o),n=I("%")},m(t,o){S(t,e,o),S(t,n,o)},p(t,n){1&n&&o!==(o=Math.round(t[0].counter.done/t[0].counter.total*100)+"")&&F(e,o)},d(t){t&&T(e),t&&T(n)}}}function Ls(t){let e,n,o,s=t[0].counter.done+"",i=t[0].counter.total+"";return{c(){e=I(s),n=I("/"),o=I(i)},m(t,s){S(t,e,s),S(t,n,s),S(t,o,s)},p(t,n){1&n&&s!==(s=t[0].counter.done+"")&&F(e,s),1&n&&i!==(i=t[0].counter.total+"")&&F(o,i)},d(t){t&&T(e),t&&T(n),t&&T(o)}}}function Ys(t){let e,n,o,s,i=t[13],r=[];for(let e=0;e<i.length;e+=1)r[e]=Bs(Ms(t,i,e));const a=t=>pt(r[t],1,1,(()=>{r[t]=null}));let c=t[13].length>3&&Hs(t);return{c(){e=C("div");for(let t=0;t<r.length;t+=1)r[t].c();n=P(),c&&c.c(),A(e,"class","wx-todo_user-menu svelte-1wld78x"),R(e,"width",(t[13].length>=3?60:22*t[13].length)+"px"),A(e,"data-user-menu-id",o=t[0].id)},m(t,o){S(t,e,o);for(let t=0;t<r.length;t+=1)r[t].m(e,null);j(e,n),c&&c.m(e,null),s=!0},p(t,l){if(8192&l){let o;for(i=t[13],o=0;o<i.length;o+=1){const s=Ms(t,i,o);r[o]?(r[o].p(s,l),ut(r[o],1)):(r[o]=Bs(s),r[o].c(),ut(r[o],1),r[o].m(e,n))}for(lt(),o=i.length;o<r.length;o+=1)a(o);dt()}t[13].length>3?c?(c.p(t,l),8192&l&&ut(c,1)):(c=Hs(t),c.c(),ut(c,1),c.m(e,null)):c&&(lt(),pt(c,1,1,(()=>{c=null})),dt()),(!s||8192&l)&&R(e,"width",(t[13].length>=3?60:22*t[13].length)+"px"),(!s||1&l&&o!==(o=t[0].id))&&A(e,"data-user-menu-id",o)},i(t){if(!s){for(let t=0;t<i.length;t+=1)ut(r[t]);ut(c),s=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)pt(r[t]);pt(c),s=!1},d(t){t&&T(e),D(r,t),c&&c.d()}}}function zs(t){let e,n,o;return n=new xo({props:{color:t[25].color,avatar:t[25].avatar}}),{c(){e=C("div"),vt(n.$$.fragment),A(e,"class","wx-todo_user-menu__avatar svelte-1wld78x"),R(e,"left",16*t[27]+"px")},m(t,s){S(t,e,s),kt(n,e,null),o=!0},p(t,e){const o={};8192&e&&(o.color=t[25].color),8192&e&&(o.avatar=t[25].avatar),n.$set(o)},i(t){o||(ut(n.$$.fragment,t),o=!0)},o(t){pt(n.$$.fragment,t),o=!1},d(t){t&&T(e),xt(n)}}}function Bs(t){let e,n,o=(3===t[13].length&&t[27]<3||t[27]<2)&&zs(t);return{c(){o&&o.c(),e=M()},m(t,s){o&&o.m(t,s),S(t,e,s),n=!0},p(t,n){3===t[13].length&&t[27]<3||t[27]<2?o?(o.p(t,n),8192&n&&ut(o,1)):(o=zs(t),o.c(),ut(o,1),o.m(e.parentNode,e)):o&&(lt(),pt(o,1,1,(()=>{o=null})),dt())},i(t){n||(ut(o),n=!0)},o(t){pt(o),n=!1},d(t){o&&o.d(t),t&&T(e)}}}function Hs(t){let e,n,o;return n=new xo({props:{value:"+"+(t[13].length-2)}}),{c(){e=C("div"),vt(n.$$.fragment),A(e,"class","wx-todo_user-menu__avatar svelte-1wld78x"),R(e,"left","32px")},m(t,s){S(t,e,s),kt(n,e,null),o=!0},p(t,e){const o={};8192&e&&(o.value="+"+(t[13].length-2)),n.$set(o)},i(t){o||(ut(n.$$.fragment,t),o=!0)},o(t){pt(n.$$.fragment,t),o=!1},d(t){t&&T(e),xt(n)}}}function Ws(t){let e,n,o,s;return n=new lo({props:{name:"dots-v"}}),{c(){e=C("button"),vt(n.$$.fragment),A(e,"data-menu-id",o=t[0].id),A(e,"class","wx-todo_list-menu-button svelte-1wld78x")},m(t,o){S(t,e,o),kt(n,e,null),s=!0},p(t,n){(!s||1&n&&o!==(o=t[0].id))&&A(e,"data-menu-id",o)},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&T(e),xt(n)}}}function Gs(t){let e,n,o,s="user"===t[3].type&&Vs(t),i="task"===t[3].type&&Js(t);return{c(){s&&s.c(),e=P(),i&&i.c(),n=M()},m(t,r){s&&s.m(t,r),S(t,e,r),i&&i.m(t,r),S(t,n,r),o=!0},p(t,o){"user"===t[3].type?s?(s.p(t,o),8&o&&ut(s,1)):(s=Vs(t),s.c(),ut(s,1),s.m(e.parentNode,e)):s&&(lt(),pt(s,1,1,(()=>{s=null})),dt()),"task"===t[3].type?i?(i.p(t,o),8&o&&ut(i,1)):(i=Js(t),i.c(),ut(i,1),i.m(n.parentNode,n)):i&&(lt(),pt(i,1,1,(()=>{i=null})),dt())},i(t){o||(ut(s),ut(i),o=!0)},o(t){pt(s),pt(i),o=!1},d(t){s&&s.d(t),t&&T(e),i&&i.d(t),t&&T(n)}}}function Vs(t){let e,n;return e=new Vo({props:{coords:t[3].coords,data:t[13]}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.coords=t[3].coords),8192&n&&(o.data=t[13]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Js(t){let e,n;return e=new ls({props:{coords:t[3].coords,data:t[3].data}}),e.$on("click",t[18]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.coords=t[3].coords),8&n&&(o.data=t[3].data),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Us(t){let e,n,o,s,i,r,a,c,l,d,u,p,f,h,g,$,m,v,k,x,w=Ee(t[3].id,t[0].id)&&t[3].open,b=t[10]&&Ns(t);s=new ho({props:{checked:t[0].checked}}),s.$on("change",t[15]);const y=[Fs,As],_=[];function D(t,e){return t[11]&&!t[7]?0:1}c=D(t),l=_[c]=y[c](t),u=new Ps({props:{id:t[0].id,datePicker:t[8],format:t[6]?.date?.format,validate:t[6]?.date?.validate,completed:t[0].checked,date:t[0].due_date}}),u.$on("action",t[22]);let I=t[10]&&Os(t),N=t[13]?.length&&Ys(t),E=!t[7]&&Ws(t),F=w&&Gs(t);return{c(){e=C("div"),n=C("div"),b&&b.c(),o=P(),vt(s.$$.fragment),i=P(),r=C("div"),a=C("div"),l.c(),d=P(),vt(u.$$.fragment),f=P(),h=C("div"),I&&I.c(),g=P(),N&&N.c(),$=P(),E&&E.c(),v=P(),F&&F.c(),k=M(),A(n,"class","wx-todo_list__controls wx-todo_list__controls-manual svelte-1wld78x"),A(a,"class","wx-todo_list__text svelte-1wld78x"),A(r,"class","wx-todo_list__content svelte-1wld78x"),A(r,"data-list-editor-id",p=t[0].id),A(h,"class","wx-todo_list__controls svelte-1wld78x"),A(e,"tabindex","0"),A(e,"data-list-id",m=t[0].id),A(e,"class","wx-todo_list svelte-1wld78x"),R(e,"padding-left",t[12]+"px"),L(e,"wx-todo_list--selected",Ee(t[0].id,t[1])&&!t[11])},m(l,p){S(l,e,p),j(e,n),b&&b.m(n,null),j(n,o),kt(s,n,null),j(e,i),j(e,r),j(r,a),_[c].m(a,null),j(r,d),kt(u,r,null),j(e,f),j(e,h),I&&I.m(h,null),j(h,g),N&&N.m(h,null),j(h,$),E&&E.m(h,null),t[23](e),S(l,v,p),F&&F.m(l,p),S(l,k,p),x=!0},p(t,[i]){t[10]?b?(b.p(t,i),1024&i&&ut(b,1)):(b=Ns(t),b.c(),ut(b,1),b.m(n,o)):b&&(lt(),pt(b,1,1,(()=>{b=null})),dt());const d={};1&i&&(d.checked=t[0].checked),s.$set(d);let f=c;c=D(t),c===f?_[c].p(t,i):(lt(),pt(_[f],1,1,(()=>{_[f]=null})),dt(),l=_[c],l?l.p(t,i):(l=_[c]=y[c](t),l.c()),ut(l,1),l.m(a,null));const v={};1&i&&(v.id=t[0].id),256&i&&(v.datePicker=t[8]),64&i&&(v.format=t[6]?.date?.format),64&i&&(v.validate=t[6]?.date?.validate),1&i&&(v.completed=t[0].checked),1&i&&(v.date=t[0].due_date),u.$set(v),(!x||1&i&&p!==(p=t[0].id))&&A(r,"data-list-editor-id",p),t[10]?I?I.p(t,i):(I=Os(t),I.c(),I.m(h,g)):I&&(I.d(1),I=null),t[13]?.length?N?(N.p(t,i),8192&i&&ut(N,1)):(N=Ys(t),N.c(),ut(N,1),N.m(h,$)):N&&(lt(),pt(N,1,1,(()=>{N=null})),dt()),t[7]?E&&(lt(),pt(E,1,1,(()=>{E=null})),dt()):E?(E.p(t,i),128&i&&ut(E,1)):(E=Ws(t),E.c(),ut(E,1),E.m(h,null)),(!x||1&i&&m!==(m=t[0].id))&&A(e,"data-list-id",m),(!x||4096&i)&&R(e,"padding-left",t[12]+"px"),2051&i&&L(e,"wx-todo_list--selected",Ee(t[0].id,t[1])&&!t[11]),9&i&&(w=Ee(t[3].id,t[0].id)&&t[3].open),w?F?(F.p(t,i),9&i&&ut(F,1)):(F=Gs(t),F.c(),ut(F,1),F.m(k.parentNode,k)):F&&(lt(),pt(F,1,1,(()=>{F=null})),dt())},i(t){x||(ut(b),ut(s.$$.fragment,t),ut(l),ut(u.$$.fragment,t),ut(N),ut(E),ut(F),x=!0)},o(t){pt(b),pt(s.$$.fragment,t),pt(l),pt(u.$$.fragment,t),pt(N),pt(E),pt(F),x=!1},d(n){n&&T(e),b&&b.d(),xt(s),_[c].d(),xt(u),I&&I.d(),N&&N.d(),E&&E.d(),t[23](null),n&&T(v),F&&F.d(n),n&&T(k)}}}function qs(t,e,n){let o,s,i,r,a;var c;const l=G(),d=J("wx-i18n").getGroup("todo");let{task:u}=e,{level:p=0}=e,{selected:f}=e,{editor:h}=e,{menu:g}=e,{filter:$}=e,{tags:m}=e,{shape:v}=e,{readonly:k}=e,{dueDate:x}=e,w=null;return Ee(u.id,f)&&W((()=>null==w?void 0:w.focus())),t.$$set=t=>{"task"in t&&n(0,u=t.task),"level"in t&&n(19,p=t.level),"selected"in t&&n(1,f=t.selected),"editor"in t&&n(2,h=t.editor),"menu"in t&&n(3,g=t.menu),"filter"in t&&n(4,$=t.filter),"tags"in t&&n(5,m=t.tags),"shape"in t&&n(6,v=t.shape),"readonly"in t&&n(7,k=t.readonly),"dueDate"in t&&n(8,x=t.dueDate)},t.$$.update=()=>{768&t.$$.dirty&&(null==x?void 0:x.open)&&(null==w||w.focus()),1&t.$$.dirty&&n(13,o=null==u?void 0:u.availableUsers),1048577&t.$$.dirty&&n(10,s=null===n(20,c=null==u?void 0:u.children)||void 0===c?void 0:c.length),1024&t.$$.dirty&&n(21,i=s?16:40),2621440&t.$$.dirty&&n(12,r=i+(p>1?24*(p-1):0)),5&t.$$.dirty&&n(11,a="task"===(null==h?void 0:h.type)&&Ee(null==h?void 0:h.id,u.id))},[u,f,h,g,$,m,v,k,x,w,s,a,r,o,d,function(){l("action",{action:u.checked?"uncheck-task":"check-task",data:{id:u.id}})},function(){l("action",{action:u.collapsed?"expand-task":"collapse-task",data:{id:u.id}})},function(t){const{value:e,dropdown:n,targetDate:o}=t.detail;l("action",{action:"edit-item",data:{id:u.id,currentValue:e,dropdown:n,targetDate:o}})},function(t){var e,n;l("action",{action:"click-menu-item",data:{id:g.id,action:null===(e=null==t?void 0:t.detail)||void 0===e?void 0:e.id,extra:null===(n=null==t?void 0:t.detail)||void 0===n?void 0:n.extra}})},p,c,i,function(e){U.call(this,t,e)},function(t){Q[t?"unshift":"push"]((()=>{w=t,n(9,w)}))}]}class Qs extends yt{constructor(t){super(),bt(this,t,qs,Us,f,{task:0,level:19,selected:1,editor:2,menu:3,filter:4,tags:5,shape:6,readonly:7,dueDate:8})}}function Ks(t,e,n){const o=t.slice();return o[23]=e[n],o}function Xs(t){let e,n;return e=new oi({props:{dataStore:t[0],level:t[2]+1,data:t[23].children}}),e.$on("action",t[22]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.dataStore=t[0]),4&n&&(o.level=t[2]+1),2&n&&(o.data=t[23].children),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Zs(t){let e,n;return e=new qo({}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function ti(t,e){let n,o,s,i,r,a,c;o=new Qs({props:{task:e[23],level:e[2]+1,readonly:e[3],editor:e[4],selected:e[5],menu:e[6],filter:e[7],shape:e[8],tags:e[9],dueDate:e[10]}}),o.$on("action",e[21]);const l=e[20].default,d=$(l,e,e[19],null);let u=e[23].children.length&&!e[23].collapsed&&Xs(e),p=0===e[2]&&Zs();return{key:t,first:null,c(){n=C("li"),vt(o.$$.fragment),s=P(),d&&d.c(),i=P(),u&&u.c(),r=P(),p&&p.c(),a=P(),A(n,"class","wx-todo_tree__row svelte-g1akb"),this.first=n},m(t,e){S(t,n,e),kt(o,n,null),j(n,s),d&&d.m(n,null),j(n,i),u&&u.m(n,null),j(n,r),p&&p.m(n,null),j(n,a),c=!0},p(t,s){e=t;const i={};2&s&&(i.task=e[23]),4&s&&(i.level=e[2]+1),8&s&&(i.readonly=e[3]),16&s&&(i.editor=e[4]),32&s&&(i.selected=e[5]),64&s&&(i.menu=e[6]),128&s&&(i.filter=e[7]),256&s&&(i.shape=e[8]),512&s&&(i.tags=e[9]),1024&s&&(i.dueDate=e[10]),o.$set(i),d&&d.p&&(!c||524288&s)&&k(d,l,e,e[19],c?v(l,e[19],s,null):x(e[19]),null),e[23].children.length&&!e[23].collapsed?u?(u.p(e,s),2&s&&ut(u,1)):(u=Xs(e),u.c(),ut(u,1),u.m(n,r)):u&&(lt(),pt(u,1,1,(()=>{u=null})),dt()),0===e[2]?p?4&s&&ut(p,1):(p=Zs(),p.c(),ut(p,1),p.m(n,a)):p&&(lt(),pt(p,1,1,(()=>{p=null})),dt())},i(t){c||(ut(o.$$.fragment,t),ut(d,t),ut(u),ut(p),c=!0)},o(t){pt(o.$$.fragment,t),pt(d,t),pt(u),pt(p),c=!1},d(t){t&&T(n),xt(o),d&&d.d(t),u&&u.d(),p&&p.d()}}}function ei(t){let e,n,o=[],s=new Map,i=t[1];const r=t=>t[23].id;for(let e=0;e<i.length;e+=1){let n=Ks(t,i,e),a=r(n);s.set(a,o[e]=ti(a,n))}return{c(){e=C("ul");for(let t=0;t<o.length;t+=1)o[t].c();A(e,"class","wx-todo_tree svelte-g1akb")},m(t,s){S(t,e,s);for(let t=0;t<o.length;t+=1)o[t].m(e,null);n=!0},p(t,[n]){526335&n&&(i=t[1],lt(),o=$t(o,n,r,1,t,i,s,e,gt,ti,null,Ks),dt())},i(t){if(!n){for(let t=0;t<i.length;t+=1)ut(o[t]);n=!0}},o(t){for(let t=0;t<o.length;t+=1)pt(o[t]);n=!1},d(t){t&&T(e);for(let t=0;t<o.length;t+=1)o[t].d()}}}function ni(t,e,n){let o,s,i,r,a,c,l,d,{$$slots:u={},$$scope:p}=e,{dataStore:f}=e,{data:h}=e,{level:$=0}=e;const m=f.selected;g(t,m,(t=>n(5,i=t)));const v=f.editableItem;g(t,v,(t=>n(4,s=t)));const k=f.menu;g(t,k,(t=>n(6,r=t)));const x=f.filter;g(t,x,(t=>n(7,a=t)));const w=f.tags;g(t,w,(t=>n(9,l=t)));const b=f.taskShape;g(t,b,(t=>n(8,c=t)));const y=f.readonly;g(t,y,(t=>n(3,o=t)));const _=f.stateDueDate;return g(t,_,(t=>n(10,d=t))),t.$$set=t=>{"dataStore"in t&&n(0,f=t.dataStore),"data"in t&&n(1,h=t.data),"level"in t&&n(2,$=t.level),"$$scope"in t&&n(19,p=t.$$scope)},[f,h,$,o,s,i,r,a,c,l,d,m,v,k,x,w,b,y,_,p,u,function(e){U.call(this,t,e)},function(e){U.call(this,t,e)}]}class oi extends yt{constructor(t){super(),bt(this,t,ni,ei,f,{dataStore:0,data:1,level:2})}}function si(t){let e,n;return e=new oi({props:{data:t[1],dataStore:t[0]}}),e.$on("action",t[3]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,[n]){const o={};2&n&&(o.data=t[1]),1&n&&(o.dataStore=t[0]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function ii(t,e,n){let o,{dataStore:s}=e;const i=s.treeTasks;return g(t,i,(t=>n(1,o=t))),t.$$set=t=>{"dataStore"in t&&n(0,s=t.dataStore)},[s,o,i,function(e){U.call(this,t,e)}]}class ri extends yt{constructor(t){super(),bt(this,t,ii,si,f,{dataStore:0})}}function ai(t){let e,n,o,s,i,r;return o=new lo({props:{name:"plus",size:16}}),{c(){e=C("div"),n=C("div"),vt(o.$$.fragment),s=P(),i=C("span"),i.textContent=`${t[0]("Add task")}`,A(n,"class","wx-todo_button-add__icon svelte-4h1ly4"),A(i,"class","wx-todo_button-add__text svelte-4h1ly4"),A(e,"class","wx-todo_button-add__content svelte-4h1ly4")},m(t,a){S(t,e,a),j(e,n),kt(o,n,null),j(e,s),j(e,i),r=!0},p:a,i(t){r||(ut(o.$$.fragment,t),r=!0)},o(t){pt(o.$$.fragment,t),r=!1},d(t){t&&T(e),xt(o)}}}function ci(t){let e,n,o,s,i;return n=new mo({props:{height:36,width:"100%",$$slots:{default:[ai]},$$scope:{ctx:t}}}),n.$on("click",t[1]),s=new qo({props:{padding:"6px 16px 0 16px"}}),{c(){e=C("div"),vt(n.$$.fragment),o=P(),vt(s.$$.fragment),A(e,"class","wx-todo_button-add svelte-4h1ly4")},m(t,r){S(t,e,r),kt(n,e,null),j(e,o),kt(s,e,null),i=!0},p(t,[e]){const o={};4&e&&(o.$$scope={dirty:e,ctx:t}),n.$set(o)},i(t){i||(ut(n.$$.fragment,t),ut(s.$$.fragment,t),i=!0)},o(t){pt(n.$$.fragment,t),pt(s.$$.fragment,t),i=!1},d(t){t&&T(e),xt(n),xt(s)}}}function li(t){return[J("wx-i18n").getGroup("todo"),function(e){U.call(this,t,e)}]}class di extends yt{constructor(t){super(),bt(this,t,li,ci,f,{})}}const ui=[];function pi(t,e=a){let n;const o=new Set;function s(e){if(f(t,e)&&(t=e,n)){const e=!ui.length;for(const e of o)e[1](),ui.push(e,t);if(e){for(let t=0;t<ui.length;t+=2)ui[t][0](ui[t+1]);ui.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(i,r=a){const c=[i,r];return o.add(c),1===o.size&&(n=e(s)||a),i(t),()=>{o.delete(c),0===o.size&&(n(),n=null)}}}}function fi(t){let e,n;return e=new di({}),e.$on("click",t[5]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p:a,i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function hi(t){let e,n,o,s,i,r,a,c,l=!t[1]&&fi(t);return s=new ri({props:{dataStore:t[3]}}),s.$on("action",t[4]),{c(){e=C("div"),l&&l.c(),n=P(),o=C("div"),vt(s.$$.fragment),A(o,"class","wx-todo__wrapper svelte-1h4t0xo"),A(e,"class","wx-todo svelte-1h4t0xo"),A(e,"data-todo-id",t[0])},m(d,u){S(d,e,u),l&&l.m(e,null),j(e,n),j(e,o),kt(s,o,null),r=!0,a||(c=[N(o,"contextmenu",mi),_(oo.call(null,o,{api:t[2]})),_(no.call(null,o,{api:t[2]})),_(Zn.call(null,o,{api:t[2]})),_(i=to.call(null,o,{api:t[2],readonly:t[1]})),_(eo.call(null,o,{api:t[2]}))],a=!0)},p(t,o){t[1]?l&&(lt(),pt(l,1,1,(()=>{l=null})),dt()):l?(l.p(t,o),2&o&&ut(l,1)):(l=fi(t),l.c(),ut(l,1),l.m(e,n)),i&&p(i.update)&&2&o&&i.update.call(null,{api:t[2],readonly:t[1]}),(!r||1&o)&&A(e,"data-todo-id",t[0])},i(t){r||(ut(l),ut(s.$$.fragment,t),r=!0)},o(t){pt(l),pt(s.$$.fragment,t),r=!1},d(t){t&&T(e),l&&l.d(),xt(s),a=!1,u(c)}}}function gi(t){let e,n;return e=new be({props:{$$slots:{default:[hi]},$$scope:{ctx:t}}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};65539&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function $i(t){let e,n,o,s,i,r;return o=new ve({props:{words:{..._e,...ye},optional:!0,$$slots:{default:[gi]},$$scope:{ctx:t}}}),{c(){vt(o.$$.fragment)},m(a,c){kt(o,a,c),s=!0,i||(r=[_(e=io.call(null,window,{api:t[2],widgetId:t[0]})),_(n=so.call(null,window,{api:t[2],readonly:t[1]}))],i=!0)},p(t,[s]){e&&p(e.update)&&1&s&&e.update.call(null,{api:t[2],widgetId:t[0]}),n&&p(n.update)&&2&s&&n.update.call(null,{api:t[2],readonly:t[1]});const i={};65539&s&&(i.$$scope={dirty:s,ctx:t}),o.$set(i)},i(t){s||(ut(o.$$.fragment,t),s=!0)},o(t){pt(o.$$.fragment,t),s=!1},d(t){xt(o,t),i=!1,u(r)}}}const mi=t=>t.preventDefault();function vi(t,e,n){let{id:o=Ne()}=e,{tasks:s=[]}=e,{projects:i=[]}=e,{users:r=[]}=e,{tags:a=[]}=e,{selected:c=null}=e,{activeProject:l}=e,{readonly:d=!1}=e,{taskShape:u=Ve}=e;const p=G(),f=new Hn(pi),h=f.getReactive();let g=new Pe(p);const $=function(t,e){let n=e;return{exec:t.in.exec,getState:t.getState.bind(t),getReactiveState:t.getReactive.bind(t),setNext:t=>{n.setNext(t.exec),n=t},getStores:()=>({state:t}),intercept:t.in.on.bind(t.in),on:t.out.on.bind(t.out),serialize:()=>t.serialize(),parse:e=>t.parse(e),existsTask:({id:e})=>t.existsTask(e),existsProject:({id:e})=>t.existsProject(e),getTask:({id:e})=>t.getTask(e),getProject:({id:e})=>t.getProject(e),hasChildren:({id:e,filtered:n})=>t.hasChildren(e,n),getChildrenIds:({id:e,filtered:n,tree:o})=>t.getChildrenIds({id:e,filtered:n,tree:o}),getParentIds:({id:e})=>t.getParentIds(e)}}(f,g);return f.out.setNext(g.exec),t.$$set=t=>{"id"in t&&n(0,o=t.id),"tasks"in t&&n(6,s=t.tasks),"projects"in t&&n(7,i=t.projects),"users"in t&&n(8,r=t.users),"tags"in t&&n(9,a=t.tags),"selected"in t&&n(10,c=t.selected),"activeProject"in t&&n(11,l=t.activeProject),"readonly"in t&&n(1,d=t.readonly),"taskShape"in t&&n(12,u=t.taskShape)},t.$$.update=()=>{8131&t.$$.dirty&&f.init({tasks:s,users:r,tags:a,selected:c,taskShape:Object.assign(Object.assign({},Ve),u),projects:i,activeProject:l,readonly:d,id:o})},[o,d,$,h,function(t){const{action:e,data:n}=t.detail;f.in.exec(e,n)},function(t){Ae(f.getState().filter)||(t.stopPropagation(),jn(f,{},!0))},s,i,r,a,c,l,u]}class ki extends yt{constructor(t){super(),bt(this,t,vi,$i,f,{id:0,tasks:6,projects:7,users:8,tags:9,selected:10,activeProject:11,readonly:1,taskShape:12,api:2})}get api(){return this.$$.ctx[2]}}function xi(t){let e;const n=t[1].default,o=$(n,t,t[2],null);return{c(){o&&o.c()},m(t,n){o&&o.m(t,n),e=!0},p(t,s){o&&o.p&&(!e||4&s)&&k(o,n,t,t[2],e?v(n,t[2],s,null):x(t[2]),null)},i(t){e||(ut(o,t),e=!0)},o(t){pt(o,t),e=!1},d(t){o&&o.d(t)}}}function wi(t){let e,n,o=t[0]&&xi(t);return{c(){e=C("div"),o&&o.c(),A(e,"class","wx-todo_toolbar svelte-18c2a5y")},m(t,s){S(t,e,s),o&&o.m(e,null),n=!0},p(t,n){t[0]?o?(o.p(t,n),1&n&&ut(o,1)):(o=xi(t),o.c(),ut(o,1),o.m(e,null)):o&&(lt(),pt(o,1,1,(()=>{o=null})),dt())},i(t){n||(ut(o),n=!0)},o(t){pt(o),n=!1},d(t){t&&T(e),o&&o.d()}}}function bi(t){let e,n;return e=new ve({props:{words:{..._e,...ye},optional:!0,$$slots:{default:[wi]},$$scope:{ctx:t}}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,[n]){const o={};5&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function yi(t,e,n){let{$$slots:o={},$$scope:s}=e,{api:i}=e;return t.$$set=t=>{"api"in t&&n(0,i=t.api),"$$scope"in t&&n(2,s=t.$$scope)},[i,o,s]}class _i extends yt{constructor(t){super(),bt(this,t,yi,bi,f,{api:0})}}function ji(t){let e,n,o,s;return n=new lo({props:{name:"dots-v"}}),n.$on("click",t[11]),{c(){e=C("button"),vt(n.$$.fragment),A(e,"class","wx-todo_toolbar-menu-button svelte-r66yne"),A(e,"tabindex","0"),A(e,"data-toolbar-icon",o=!0),A(e,"data-todo-id",t[8])},m(t,o){S(t,e,o),kt(n,e,null),s=!0},p(t,n){(!s||256&n)&&A(e,"data-todo-id",t[8])},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&T(e),xt(n)}}}function Si(t){let e,n;return e=new Bo({props:{coords:t[0].coords,data:t[1],offset:10,$$slots:{default:[Ti,({item:t})=>({17:t}),({item:t})=>t?131072:0]},$$scope:{ctx:t}}}),e.$on("click",t[9]),e.$on("cancel",t[10]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.coords=t[0].coords),2&n&&(o.data=t[1]),393216&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Ti(t){let e,n;return e=new Co({props:{label:t[17].label,icon:t[17].icon,disabled:t[17]?.disabled,clickable:!0}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};131072&n&&(o.label=t[17].label),131072&n&&(o.icon=t[17].icon),131072&n&&(o.disabled=t[17]?.disabled),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Di(t){let e,n,o,s=!t[7]&&ji(t),i=t[0]?.open&&"project"===t[0]?.type&&Si(t);return{c(){s&&s.c(),e=P(),i&&i.c(),n=M()},m(t,r){s&&s.m(t,r),S(t,e,r),i&&i.m(t,r),S(t,n,r),o=!0},p(t,[o]){t[7]?s&&(lt(),pt(s,1,1,(()=>{s=null})),dt()):s?(s.p(t,o),128&o&&ut(s,1)):(s=ji(t),s.c(),ut(s,1),s.m(e.parentNode,e)),t[0]?.open&&"project"===t[0]?.type?i?(i.p(t,o),1&o&&ut(i,1)):(i=Si(t),i.c(),ut(i,1),i.m(n.parentNode,n)):i&&(lt(),pt(i,1,1,(()=>{i=null})),dt())},i(t){o||(ut(s),ut(i),o=!0)},o(t){pt(s),pt(i),o=!1},d(t){s&&s.d(t),t&&T(e),i&&i.d(t),t&&T(n)}}}function Ci(t,e,n){let o,s,i,r,c,l,d,u,p,f,g,$,m=a,v=a,k=a,x=a,w=a;t.$$.on_destroy.push((()=>m())),t.$$.on_destroy.push((()=>v())),t.$$.on_destroy.push((()=>k())),t.$$.on_destroy.push((()=>x())),t.$$.on_destroy.push((()=>w()));let{api:b}=e;const y=J("wx-i18n").getGroup("todo");return t.$$set=t=>{"api"in t&&n(12,b=t.api)},t.$$.update=()=>{4096&t.$$.dirty&&n(13,o=b.getReactiveState()),8192&t.$$.dirty&&(n(6,s=o.id),w(),w=h(s,(t=>n(8,$=t)))),8192&t.$$.dirty&&(n(5,i=o.menu),m(),m=h(i,(t=>n(0,u=t)))),8192&t.$$.dirty&&(n(4,r=o.projects),k(),k=h(r,(t=>n(15,f=t)))),8192&t.$$.dirty&&(n(3,c=o.activeProject),v(),v=h(c,(t=>n(14,p=t)))),8192&t.$$.dirty&&(n(2,l=o.readonly),x(),x=h(l,(t=>n(7,g=t)))),1&t.$$.dirty&&n(1,d=Le((null==u?void 0:u.data)||[],y))},[u,d,l,c,r,i,s,g,$,function(t){const e=t.detail.id;switch(e){case"add":!function(t,e){const n=e?.id||Ne().toString();t.in.exec("add-project",{id:n,project:{label:e?.label||"New project"}}),t.in.exec("set-project",{id:n}),t.in.exec("open-inline-editor",{id:n,type:"project"})}(null==b?void 0:b.getStores().state,{id:Ne().toString(),label:Be("New project",f,y)});break;case"rename":b.exec("open-inline-editor",{id:p,type:"project"});break;case"delete":b.exec("delete-project",{id:p})}e&&b.exec("close-menu",Object.assign({},u))},function(t){const e=En(t.detail.event,"data-toolbar-icon");(null==u?void 0:u.open)&&!Ae(e)&&b.exec("close-menu",Object.assign({},u))},function(t){const{menu:e,activeProject:n}=b.getState();(null==e?void 0:e.open)&&"project"===e.type?b.exec("close-menu",Object.assign({},e)):b.exec("open-menu",{id:n,type:"project",coords:On(t)})},b,o]}class Ii extends yt{constructor(t){super(),bt(this,t,Ci,Di,f,{api:12})}}function Pi(t){let e,n;return e=new lo({props:{name:"close",clickable:!0}}),e.$on("click",t[3]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p:a,i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Mi(t){let e,n,o,s,i,r,a=t[0]&&Pi(t);return{c(){e=C("div"),n=C("input"),o=P(),a&&a.c(),A(n,"class","wx-todo_input__value svelte-4g7y4h"),A(n,"placeholder",t[1]),A(e,"class","wx-todo_input svelte-4g7y4h")},m(c,l){S(c,e,l),j(e,n),t[7](n),O(n,t[0]),j(e,o),a&&a.m(e,null),s=!0,i||(r=[N(n,"input",t[8]),N(n,"keypress",t[4]),N(n,"focus",t[5]),N(n,"blur",t[6])],i=!0)},p(t,[o]){(!s||2&o)&&A(n,"placeholder",t[1]),1&o&&n.value!==t[0]&&O(n,t[0]),t[0]?a?(a.p(t,o),1&o&&ut(a,1)):(a=Pi(t),a.c(),ut(a,1),a.m(e,null)):a&&(lt(),pt(a,1,1,(()=>{a=null})),dt())},i(t){s||(ut(a),s=!0)},o(t){pt(a),s=!1},d(n){n&&T(e),t[7](null),a&&a.d(),i=!1,u(r)}}}function Ni(t,e,n){let{placeholder:o=""}=e,{value:s=""}=e,i=null;const r=G();return t.$$set=t=>{"placeholder"in t&&n(1,o=t.placeholder),"value"in t&&n(0,s=t.value)},t.$$.update=()=>{5&t.$$.dirty&&(i||s)&&setTimeout((()=>Fn(i)))},[s,o,i,function(){n(0,s=""),r("clear"),null==i||i.focus()},function(e){U.call(this,t,e)},function(e){U.call(this,t,e)},function(e){U.call(this,t,e)},function(t){Q[t?"unshift":"push"]((()=>{i=t,n(2,i)}))},function(){s=this.value,n(0,s)}]}class Ei extends yt{constructor(t){super(),bt(this,t,Ni,Mi,f,{placeholder:1,value:0})}}function Ai(t){let e,n,o,s;function i(e){t[21](e)}let r={placeholder:t[7]("Search")};return void 0!==t[1].value&&(r.value=t[1].value),n=new Ei({props:r}),Q.push((()=>mt(n,"value",i))),n.$on("focus",t[9]),n.$on("blur",t[10]),{c(){e=C("div"),vt(n.$$.fragment),A(e,"class","wx-todo_search__input svelte-1kurht3")},m(o,i){S(o,e,i),kt(n,e,null),t[22](e),s=!0},p(t,e){const s={};!o&&2&e&&(o=!0,s.value=t[1].value,nt((()=>o=!1))),n.$set(s)},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(o){o&&T(e),xt(n),t[22](null)}}}function Fi(t){let e,n;return e=new Bo({props:{offset:10,coords:t[1].dropdown.coords,data:t[1].dropdown.data,$$slots:{default:[Oi,({item:t})=>({24:t}),({item:t})=>t?16777216:0]},$$scope:{ctx:t}}}),e.$on("click",t[11]),e.$on("cancel",t[12]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.coords=t[1].dropdown.coords),2&n&&(o.data=t[1].dropdown.data),50331648&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Oi(t){let e,n;return e=new Co({props:{label:t[24].label,clickable:!0}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};16777216&n&&(o.label=t[24].label),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Ri(t){let e,n,o,s,i,r;n=new lo({props:{name:"search",clickable:!0}}),n.$on("click",t[8]);let a=t[1]?.open&&Ai(t),c=t[0]&&t[1]?.dropdown?.open&&Fi(t);return{c(){e=C("div"),vt(n.$$.fragment),o=P(),a&&a.c(),s=P(),c&&c.c(),i=M(),A(e,"data-todo-id",t[6]),A(e,"class","wx-todo_search svelte-1kurht3"),L(e,"wx-todo_search--opened",t[1]?.open)},m(t,l){S(t,e,l),kt(n,e,null),j(e,o),a&&a.m(e,null),S(t,s,l),c&&c.m(t,l),S(t,i,l),r=!0},p(t,[n]){t[1]?.open?a?(a.p(t,n),2&n&&ut(a,1)):(a=Ai(t),a.c(),ut(a,1),a.m(e,null)):a&&(lt(),pt(a,1,1,(()=>{a=null})),dt()),(!r||64&n)&&A(e,"data-todo-id",t[6]),2&n&&L(e,"wx-todo_search--opened",t[1]?.open),t[0]&&t[1]?.dropdown?.open?c?(c.p(t,n),3&n&&ut(c,1)):(c=Fi(t),c.c(),ut(c,1),c.m(i.parentNode,i)):c&&(lt(),pt(c,1,1,(()=>{c=null})),dt())},i(t){r||(ut(n.$$.fragment,t),ut(a),ut(c),r=!0)},o(t){pt(n.$$.fragment,t),pt(a),pt(c),r=!1},d(t){t&&T(e),xt(n),a&&a.d(),t&&T(s),c&&c.d(t),t&&T(i)}}}function Li(t,e,n){let o,s,i,r,c,l,d,u,p,f=a,g=a,$=a,m=a;var v,k,x;t.$$.on_destroy.push((()=>f())),t.$$.on_destroy.push((()=>g())),t.$$.on_destroy.push((()=>$())),t.$$.on_destroy.push((()=>m()));let{api:w}=e,b=null,y=null;const _=J("wx-i18n").getGroup("todo");function j(){null==w||w.exec("set-state-search",Object.assign(Object.assign({},l),{dropdown:{open:!1}})),n(17,y=null)}return t.$$set=t=>{"api"in t&&n(13,w=t.api)},t.$$.update=()=>{8192&t.$$.dirty&&n(18,o=w.getReactiveState()),262144&t.$$.dirty&&(n(5,s=o.id),m(),m=h(s,(t=>n(6,p=t)))),262144&t.$$.dirty&&(n(4,i=o.filter),$(),$=h(i,(t=>n(20,u=t)))),262144&t.$$.dirty&&(n(3,r=o.tags),g(),g=h(r,(t=>n(19,d=t)))),262144&t.$$.dirty&&(n(2,c=o.stateSearch),f(),f=h(c,(t=>n(1,l=t)))),1826819&t.$$.dirty&&Ae(null==l?void 0:l.value)&&l.value!==((null==u?void 0:u.match)||"")&&l.focus&&((null===n(14,v=l.value)||void 0===v?void 0:v.length)?w.exec("set-filter",{match:l.value,highlight:!0,strict:(null===n(15,k=l.value)||void 0===k?void 0:k.startsWith("#"))&&d.includes(l.value)}):w.exec("set-filter",{match:null}),b&&(null===n(16,x=l.value)||void 0===x?void 0:x.startsWith("#"))&&y!==(null==l?void 0:l.value)?function(){const t=Wn(d,l.value),e=b.getBoundingClientRect();setTimeout((()=>{w.exec("set-state-search",Object.assign(Object.assign({},l),{open:!0,dropdown:{open:!0,coords:{x:e.left,y:e.bottom},data:t}}))}),(null==l?void 0:l.open)?0:250)}():j())},[b,l,c,r,i,s,p,_,function(){w.exec("set-state-search",Object.assign(Object.assign({},l),{open:!(null==l?void 0:l.open)}))},function(){w.exec("set-state-search",Object.assign(Object.assign({},l),{focus:!0}))},function(){var t;w.exec("set-state-search",Object.assign(Object.assign({},l),{focus:!1,open:!!(null===(t=l.value)||void 0===t?void 0:t.length)}))},function(t){n(17,y=t.detail.id),w.exec("set-state-search",Object.assign(Object.assign({},l),{value:(null==y?void 0:y.length)?y:null,dropdown:{open:!1}}))},j,w,v,k,x,y,o,d,u,function(e){t.$$.not_equal(l.value,e)&&(l.value=e,c.set(l))},function(t){Q[t?"unshift":"push"]((()=>{b=t,n(0,b)}))}]}class Yi extends yt{constructor(t){super(),bt(this,t,Li,Ri,f,{api:13})}}function zi(t){let e,n;return{c(){e=C("div"),n=I(t[2]),A(e,"class","wx-todo_text__value svelte-xj3elj"),A(e,"tabindex","0")},m(t,o){S(t,e,o),j(e,n)},p(t,e){4&e&&F(n,t[2])},d(t){t&&T(e)}}}function Bi(t){let e,n,o,s;return{c(){e=C("div"),n=I(t[2]),A(e,"class","wx-todo_text__value svelte-xj3elj"),A(e,"contenteditable",!0),A(e,"data-placeholder",t[1]),A(e,"tabindex","0"),L(e,"wx-todo_text__value--editing",t[0])},m(i,r){S(i,e,r),j(e,n),t[9](e),o||(s=[N(e,"blur",t[7]),N(e,"input",t[5])],o=!0)},p(t,o){4&o&&F(n,t[2]),2&o&&A(e,"data-placeholder",t[1]),1&o&&L(e,"wx-todo_text__value--editing",t[0])},d(n){n&&T(e),t[9](null),o=!1,u(s)}}}function Hi(t){let e,n,o;function s(t,e){return t[0]&&t[3]?Bi:zi}let i=s(t),r=i(t);return{c(){e=C("div"),r.c(),A(e,"class","wx-todo_text svelte-xj3elj")},m(s,i){S(s,e,i),r.m(e,null),n||(o=N(e,"dblclick",E(t[6])),n=!0)},p(t,[n]){i===(i=s(t))&&r?r.p(t,n):(r.d(1),r=i(t),r&&(r.c(),r.m(e,null)))},i:a,o:a,d(t){t&&T(e),r.d(),n=!1,o()}}}function Wi(t,e,n){let{placeholder:o=""}=e,{value:s=""}=e,{editable:i=!0}=e,{editing:r=!1}=e,{enableRange:a=!1}=e,c=null;const l=G();return t.$$set=t=>{"placeholder"in t&&n(1,o=t.placeholder),"value"in t&&n(2,s=t.value),"editable"in t&&n(3,i=t.editable),"editing"in t&&n(0,r=t.editing),"enableRange"in t&&n(8,a=t.enableRange)},t.$$.update=()=>{272&t.$$.dirty&&c&&(a?function(t){if(!t)return;const e=document.createRange(),n=window.getSelection();e.setStart(t,0),e.setEnd(t,t?.childNodes?.length||0),n.removeAllRanges(),n.addRange(e)}(c):Fn(c))},[r,o,s,i,c,function(){l("editing",{value:(null==c?void 0:c.textContent)||""})},function(){i&&!r&&(n(0,r=!0),l("open",{value:s}))},function(){r&&(n(0,r=!1),l("close",{value:s}))},a,function(t){Q[t?"unshift":"push"]((()=>{c=t,n(4,c)}))}]}class Gi extends yt{constructor(t){super(),bt(this,t,Wi,Hi,f,{placeholder:1,value:2,editable:3,editing:0,enableRange:8})}}function Vi(t,e,n){const o=t.slice();return o[31]=e[n],o}function Ji(t){let e,n;return e=new Eo({props:{coords:t[3].coords,$$slots:{default:[Qi]},$$scope:{ctx:t}}}),e.$on("cancel",t[17]),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};8&n[0]&&(o.coords=t[3].coords),19&n[0]|8&n[1]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function Ui(t){let e,n;return e=new lo({props:{name:"check"}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function qi(t,e){let n,o,s,i,r,a,c,l=e[31].label+"",d=Ee(e[1],e[31].id),u=d&&Ui();return{key:t,first:null,c(){n=C("div"),o=C("div"),s=I(l),i=P(),u&&u.c(),r=P(),A(o,"class","wx-todo_combo-item__label svelte-cneew2"),A(n,"class","wx-todo_combo-item svelte-cneew2"),A(n,"data-item-id",a=e[31].id),this.first=n},m(t,e){S(t,n,e),j(n,o),j(o,s),j(n,i),u&&u.m(n,null),j(n,r),c=!0},p(t,o){e=t,(!c||16&o[0])&&l!==(l=e[31].label+"")&&F(s,l),18&o[0]&&(d=Ee(e[1],e[31].id)),d?u?18&o[0]&&ut(u,1):(u=Ui(),u.c(),ut(u,1),u.m(n,r)):u&&(lt(),pt(u,1,1,(()=>{u=null})),dt()),(!c||16&o[0]&&a!==(a=e[31].id))&&A(n,"data-item-id",a)},i(t){c||(ut(u),c=!0)},o(t){pt(u),c=!1},d(t){t&&T(n),u&&u.d()}}}function Qi(t){let e,n,o,s,i,r,a,c,l,d,u,p,f,h,g=[],$=new Map;function m(e){t[30](e)}s=new lo({props:{name:"search"}});let v={placeholder:t[15]("Search project")};void 0!==t[0]&&(v.value=t[0]),r=new Ei({props:v}),Q.push((()=>mt(r,"value",m))),l=new qo({props:{padding:"0"}});let k=t[4];const x=t=>t[31].id;for(let e=0;e<k.length;e+=1){let n=Vi(t,k,e),o=x(n);$.set(o,g[e]=qi(o,n))}return{c(){e=C("div"),n=C("div"),o=C("div"),vt(s.$$.fragment),i=P(),vt(r.$$.fragment),c=P(),vt(l.$$.fragment),d=P(),u=C("div");for(let t=0;t<g.length;t+=1)g[t].c();A(o,"class","wx-todo_combo-search__icon svelte-cneew2"),A(n,"class","wx-todo_combo-search svelte-cneew2"),A(u,"class","wx-todo_combo-dropdown__content svelte-cneew2"),A(e,"class","wx-todo_combo-dropdown")},m(a,$){S(a,e,$),j(e,n),j(n,o),kt(s,o,null),j(n,i),kt(r,n,null),j(e,c),kt(l,e,null),j(e,d),j(e,u);for(let t=0;t<g.length;t+=1)g[t].m(u,null);p=!0,f||(h=N(u,"click",t[18]),f=!0)},p(t,e){const n={};!a&&1&e[0]&&(a=!0,n.value=t[0],nt((()=>a=!1))),r.$set(n),18&e[0]&&(k=t[4],lt(),g=$t(g,e,x,1,t,k,$,u,gt,qi,null,Vi),dt())},i(t){if(!p){ut(s.$$.fragment,t),ut(r.$$.fragment,t),ut(l.$$.fragment,t);for(let t=0;t<k.length;t+=1)ut(g[t]);p=!0}},o(t){pt(s.$$.fragment,t),pt(r.$$.fragment,t),pt(l.$$.fragment,t);for(let t=0;t<g.length;t+=1)pt(g[t]);p=!1},d(t){t&&T(e),xt(s),xt(r),xt(l);for(let t=0;t<g.length;t+=1)g[t].d();f=!1,h()}}}function Ki(t){let e,n,o,s,i,r,a,c,l,d,u;o=new Gi({props:{editing:t[6],value:t[5],enableRange:!0,placeholder:t[15]("Type what you want"),editable:Ae(t[1])&&!t[14]}}),o.$on("close",t[20]),o.$on("open",t[19]),o.$on("editing",t[21]),r=new lo({props:{name:"menu-down",clickable:!0}});let p=t[3].open&&!t[6]&&Ji(t);return{c(){e=C("div"),n=C("div"),vt(o.$$.fragment),s=P(),i=C("div"),vt(r.$$.fragment),a=P(),p&&p.c(),c=M(),A(i,"class","wx-todo_combo__icon"),A(n,"class","wx-todo_combo__wrapper svelte-cneew2"),A(e,"data-todo-id",t[13]),A(e,"class","wx-todo_combo svelte-cneew2")},m(f,h){S(f,e,h),j(e,n),kt(o,n,null),j(n,s),j(n,i),kt(r,i,null),t[29](e),S(f,a,h),p&&p.m(f,h),S(f,c,h),l=!0,d||(u=N(n,"click",E(t[16])),d=!0)},p(t,n){const s={};64&n[0]&&(s.editing=t[6]),32&n[0]&&(s.value=t[5]),16386&n[0]&&(s.editable=Ae(t[1])&&!t[14]),o.$set(s),(!l||8192&n[0])&&A(e,"data-todo-id",t[13]),t[3].open&&!t[6]?p?(p.p(t,n),72&n[0]&&ut(p,1)):(p=Ji(t),p.c(),ut(p,1),p.m(c.parentNode,c)):p&&(lt(),pt(p,1,1,(()=>{p=null})),dt())},i(t){l||(ut(o.$$.fragment,t),ut(r.$$.fragment,t),ut(p),l=!0)},o(t){pt(o.$$.fragment,t),pt(r.$$.fragment,t),pt(p),l=!1},d(n){n&&T(e),xt(o),xt(r),t[29](null),n&&T(a),p&&p.d(n),n&&T(c),d=!1,u()}}}function Xi(t,e,n){let o,s,i,r,c,l,d,u,p,f,g,$,m,v,k,x,w=a,b=a,y=a,_=a,j=a,S=a;var T;t.$$.on_destroy.push((()=>w())),t.$$.on_destroy.push((()=>b())),t.$$.on_destroy.push((()=>y())),t.$$.on_destroy.push((()=>_())),t.$$.on_destroy.push((()=>j())),t.$$.on_destroy.push((()=>S()));let{api:D}=e;const C=J("wx-i18n").getGroup("todo");let I=null,P={open:!1,coords:{x:0,y:0}},M=null,N=[];function E(){if(n(3,P.open=!P.open,P),I&&P.open){const t=I.getBoundingClientRect();n(3,P.coords={x:t.left,y:t.bottom},P)}}return t.$$set=t=>{"api"in t&&n(22,D=t.api)},t.$$.update=()=>{4194304&t.$$.dirty[0]&&n(25,o=D.getReactiveState()),33554432&t.$$.dirty[0]&&(n(12,s=o.editableItem),w(),w=h(s,(t=>n(26,g=t)))),33554432&t.$$.dirty[0]&&(n(11,i=o.activeProject),y(),y=h(i,(t=>n(1,m=t)))),33554432&t.$$.dirty[0]&&(n(10,r=o.projects),b(),b=h(r,(t=>n(27,$=t)))),33554432&t.$$.dirty[0]&&(n(9,c=o.tasks),_(),_=h(c,(t=>n(28,v=t)))),33554432&t.$$.dirty[0]&&(n(8,l=o.id),j(),j=h(l,(t=>n(13,k=t)))),33554432&t.$$.dirty[0]&&(n(7,d=o.readonly),S(),S=h(d,(t=>n(14,x=t)))),67108866&t.$$.dirty[0]&&n(6,u=Ee(null==g?void 0:g.id,m)&&"project"===(null==g?void 0:g.type)),402653184&t.$$.dirty[0]&&n(24,p=$.every((t=>Ae(t.id)))&&v.some((t=>!Ae(t.project)&&!Ae(t.parent)))?[{id:null,label:C("No project")},...$]:$),25165826&t.$$.dirty[0]&&n(5,f=((null===n(23,T=p.find((t=>Ee(m,null==t?void 0:t.id))))||void 0===T?void 0:T.label)||C("No project")).trim()),16777217&t.$$.dirty[0]&&(Ae(M)?n(4,N=p.filter((({label:t})=>t.toLowerCase().includes(M.toLowerCase())))):n(4,N=p))},[M,m,I,P,N,f,u,d,l,c,r,i,s,k,x,C,E,function(t){t=t.detail.event,P.open&&!I.contains(t.target)&&n(3,P.open=!1,P)},function(t){D.exec("set-project",{id:An(t,"data-item-id")}),E()},function(){D.exec("open-inline-editor",{id:m,type:"project"})},function(){Ae(null==g?void 0:g.id)&&D.exec("close-inline-editor",{id:g.id})},function(t){const e=t.detail.value.trim(),n=$.filter((({label:t})=>t!==f));D.exec("edit-item",{id:g.id,currentValue:e.length?e:Be("Untilted",n,C)})},D,T,p,o,g,$,v,function(t){Q[t?"unshift":"push"]((()=>{I=t,n(2,I)}))},function(t){M=t,n(0,M)}]}class Zi extends yt{constructor(t){super(),bt(this,t,Xi,Ki,f,{api:22},null,[-1,-1])}}class tr{constructor(t){this._api=t}on(t,e){this._api.on(t,e)}exec(t,e){this._api.exec(t,e)}}function er(t){let e,n;return{c(){e=new Y,n=M(),e.a=n},m(o,s){e.m(t[0],o,s),S(o,n,s)},p(t,n){1&n&&e.p(t[0])},d(t){t&&T(n),t&&e.d()}}}function nr(t){let e,n=t[0]&&er(t);return{c(){n&&n.c(),e=M()},m(t,o){n&&n.m(t,o),S(t,e,o)},p(t,[o]){t[0]?n?n.p(t,o):(n=er(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:a,o:a,d(t){n&&n.d(t),t&&T(e)}}}function or(t,e,n){let o;const s=["template"];let i=b(e,s),{template:r}=e;return t.$$set=t=>{e=c(c({},e),w(t)),n(2,i=b(e,s)),"template"in t&&n(1,r=t.template)},t.$$.update=()=>{n(0,o="function"==typeof r?r(Object.assign({},i)):r)},[o,r]}class sr extends yt{constructor(t){super(),bt(this,t,or,nr,f,{template:1})}}function ir(t,e,n){const o=t.slice();return o[2]=e[n],o}function rr(t){let e,n;return e=new sr({props:{template:t[2].type}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.template=t[2].type),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function ar(t){let e,n;return e=new sr({props:{template:t[2].template}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.template=t[2].template),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function cr(t){let e,n;return e=new Zi({props:{api:t[0]}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.api=t[0]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function lr(t){let e,n;return e=new Ii({props:{api:t[0]}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.api=t[0]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function dr(t){let e,n;return e=new Yi({props:{api:t[0]}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.api=t[0]),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function ur(t){let e,n,o,s;const i=[dr,lr,cr,ar,rr],r=[];function a(t,e){return"search"===t[2].type?0:"menu"===t[2].type?1:"combo"===t[2].type?2:t[2].template?3:t[2].type?4:-1}return~(e=a(t))&&(n=r[e]=i[e](t)),{c(){n&&n.c(),o=M()},m(t,n){~e&&r[e].m(t,n),S(t,o,n),s=!0},p(t,s){let c=e;e=a(t),e===c?~e&&r[e].p(t,s):(n&&(lt(),pt(r[c],1,1,(()=>{r[c]=null})),dt()),~e?(n=r[e],n?n.p(t,s):(n=r[e]=i[e](t),n.c()),ut(n,1),n.m(o.parentNode,o)):n=null)},i(t){s||(ut(n),s=!0)},o(t){pt(n),s=!1},d(t){~e&&r[e].d(t),t&&T(o)}}}function pr(t){let e,n,o=t[1],s=[];for(let e=0;e<o.length;e+=1)s[e]=ur(ir(t,o,e));const i=t=>pt(s[t],1,1,(()=>{s[t]=null}));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=M()},m(t,o){for(let e=0;e<s.length;e+=1)s[e].m(t,o);S(t,e,o),n=!0},p(t,n){if(3&n){let r;for(o=t[1],r=0;r<o.length;r+=1){const i=ir(t,o,r);s[r]?(s[r].p(i,n),ut(s[r],1)):(s[r]=ur(i),s[r].c(),ut(s[r],1),s[r].m(e.parentNode,e))}for(lt(),r=o.length;r<s.length;r+=1)i(r);dt()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)ut(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)pt(s[t]);n=!1},d(t){D(s,t),t&&T(e)}}}function fr(t){let e,n;return e=new _i({props:{api:t[0],$$slots:{default:[pr]},$$scope:{ctx:t}}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.api=t[0]),35&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function hr(t){let e,n;return e=new be({props:{$$slots:{default:[fr]},$$scope:{ctx:t}}}),{c(){vt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,[n]){const o={};35&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){xt(e,t)}}}function gr(t,e,n){let{api:o}=e,{items:s}=e;return t.$$set=t=>{"api"in t&&n(0,o=t.api),"items"in t&&n(1,s=t.items)},[o,s]}class $r extends yt{constructor(t){super(),bt(this,t,gr,hr,f,{api:0,items:1})}}const mr=Symbol();class vr{constructor(){this._awaitAddingQueue=[],this._queue={},this._idPool={},this.add=this.add.bind(this)}add(t,e,n){if(n.debounce){const o=`${t}"/"${e.id}`,s=this._queue[o];return s&&clearTimeout(s),void(this._queue[o]=setTimeout((()=>{this.add(t,e,{...n,debounce:!1})}),n.debounce))}const o=this.tryExec(t,e,n);null===o?this._awaitAddingQueue.push({action:t,data:e,proc:n}):o.then((t=>{t&&t.id&&t.id!=e.id&&this.isTempID(e.id)&&(this._idPool[e.id]=t.id,this.execQueue())}))}tryExec(t,e,n){const o=this.exec(t,e,n);return null===o&&this._awaitAddingQueue.push({action:t,data:e,proc:n}),o}exec(t,e,n){const o=this.correctID(e,n.ignoreID?e.id:null,n.skipCorrect);return o===mr?null:n.handler(o,t,e)}isTempID(t){return"string"==typeof t&&20===t.length&&parseInt(t.substr(7))>1e12}correctID(t,e,n){let o=null;for(const s in t){if(n&&n.includes(s))continue;const i=t[s];if("object"==typeof i){const r=this.correctID(i,e,n);if(r!==i){if(r===mr)return mr;null===o&&(o={...t}),o[s]=r}}else if(i!==e&&this.isTempID(i)){const e=this._idPool[i];if(!e)return mr;null===o&&(o={...t}),o[s]=e}}return o||t}execQueue(){this._awaitAddingQueue=this._awaitAddingQueue.map((t=>this.tryExec(t.action,t.data,t.proc)?null:t)).filter((t=>null!==t))}setID(t,e){this._idPool[t]=e}}return t.RestDataProvider=class extends Ce{constructor(t,e){super(),this._url=t,this._api=e,this._queue=new vr;const n={"add-task":{ignoreID:!0,handler:t=>this.send("tasks","POST",t)},"update-task":{handler:t=>(t.task.bunch=this.toArray(t.bunch),this.send(`tasks/${t.id}`,"PUT",t.task))},"delete-task":{handler:t=>this.send(`tasks/${t.id}`,"DELETE")},"add-project":{ignoreID:!0,handler:t=>this.send("projects","POST",t.project)},"update-project":{handler:t=>this.send(`projects/${t.id}`,"PUT",t.project)},"delete-project":{handler:t=>this.send(`projects/${t.id}`,"DELETE")},"set-project":{handler:t=>this.send(`tasks/projects/${t.id}`,"GET").then((t=>(this._api.parse({tasks:this.parseTasks(t)}),Promise.resolve())))},"move-task":{debounce:300,handler:t=>this.send(`move/${t.id}`,"PUT",t)},"clone-task":{skipCorrect:["bunch"],handler:t=>(t.bunch[0].parent=null,this.send("clone","POST",t).then((t=>{const e=t;for(const t in e)this._queue.setID(t,e[t])})))}},o=this.getHandlers(n);for(const t in o)this.on(t,(e=>{e.skipProvider||this._queue.add(t,e,o[t])}))}getTasks(){return this.send("tasks","GET").then(this.parseTasks)}getProjectTasks(t){return this.send("tasks/projects/"+t,"GET").then(this.parseTasks)}getUsers(){return this.send("users","GET")}getProjects(){return this.send("projects","GET")}getTags(){return this.send("tags","GET")}setAPI(t){this._api=t}getHandlers(t){return t}send(t,e,n,o={}){const s={method:e,headers:{"Content-Type":"application/json",...o}};return n&&(s.body="object"==typeof n?JSON.stringify(n):n),fetch(`${this._url}/${t}`,s).then((t=>t.json()))}parseTasks(t){for(let e=0;e<t.length;e++)t[e].due_date&&(t[e].due_date=new Date(t[e].due_date));return t}toArray(t){return t?Array.isArray(t)?t:Object.values(t):[]}},t.ToDo=class{constructor(t,e){this.container="string"==typeof t?document.querySelector(t):t,this.config=e,this._init()}destructor(){this._widget.$destroy(),this._widget=this.api=this.events=null}setConfig(t){t&&(this.config=Object.assign(Object.assign({},this.config),t),this._init())}parse(t){this.api.parse(t)}serialize(){return this.api.serialize()}existsTask(t){return this.api.existsTask(t)}existsProject(t){return this.api.existsProject(t)}getTask(t){return this.api.getTask(t)}getProject(t){return this.api.getProject(t)}hasChildren(t){return this.api.hasChildren(t)}getChildrenIds(t){return this.api.getChildrenIds(t)}getParentIds(t){return this.api.getParentIds(t)}setLocale(t){t&&this.setConfig({locale:t})}setFilter(t){this.api.exec("set-filter",t)}selectTask(t){this.api.exec("select-task",t)}unselectTask(t){this.api.exec("unselect-task",t)}getSelection(){return[this.api.getState().selected]}addTask(t){this.api.exec("add-task",t)}copyTask(t){this.api.exec("copy-task",t)}pasteTask(t){this.api.exec("paste-task",t)}moveTask(t){this.api.exec("move-task",t)}updateTask(t){this.api.exec("update-task",t)}deleteTask(t){this.api.exec("delete-task",t)}indentTask(t){this.api.exec("indent-task",t)}unindentTask(t){this.api.exec("unindent-task",t)}checkTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.checked)||this.api.exec("check-task",t)}uncheckTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.checked)&&this.api.exec("uncheck-task",t)}expandTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.collapsed)&&this.api.exec("expand-task",t)}collapseTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.collapsed)||this.api.exec("collapse-task",t)}openInlineEditor(t){this.api.exec("open-inline-editor",t)}closeInlineEditor(t){this.api.exec("close-inline-editor",t)}openMenu(t){this.api.exec("open-menu",t)}closeMenu(t){this.api.exec("close-menu",t)}assignUser(t){this.api.exec("assign-user",t)}unassignUser(t){this.api.exec("unassign-user",t)}addProject(t){this.api.exec("add-project",t)}updateProject(t){this.api.exec("update-project",t)}setProject(t){this.api.exec("set-project",t)}deleteProject(t){this.api.exec("delete-project",t)}_init(){var t;this._widget&&this.destructor();const e=new Map([["wx-i18n",r(null===(t=this.config)||void 0===t?void 0:t.locale)]]);this._widget=new ki({target:this.container,props:Object.assign({},this.config),context:e}),this.api=this._widget.api,this.events=new tr(this.api)}},t.Toolbar=class{constructor(t,e){this.container="string"==typeof t?document.querySelector(t):t,this.config=e,this._init()}destructor(){this._toolbar.$destroy(),this._toolbar=this.api=this.events=null}setConfig(t){t&&(this.config=Object.assign(Object.assign({},this.config),t),this._init())}setLocale(t,e){t&&this.setConfig({locale:t,api:e})}_init(){var t;this._toolbar&&this.destructor();const e=new Map([["wx-i18n",r(null===(t=this.config)||void 0===t?void 0:t.locale)]]);this._toolbar=new $r({target:this.container,props:this._configToProps(this.config),context:e}),this.events=new tr(this.api)}_configToProps(t){let e=[{type:"combo"},{type:"search"},{type:"menu"}];return(null==t?void 0:t.items)&&(e=this._normalizeItems(t.items)),Object.assign(Object.assign({},t),{items:e})}_normalizeItems(t){return t.map((t=>"string"==typeof t?{type:t}:"function"==typeof t?{type:"template",template:t}:t))}},t.uid=Se,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
